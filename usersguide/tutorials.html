<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorials &mdash; PyTables 3.9.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=e55a5be6"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Library Reference" href="libref.html" />
    <link rel="prev" title="Installation" href="installation.html" />
 
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111342564-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111342564-1');
</script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo-pytables-small.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.9.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">User’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook/index.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other_material.html">Other Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIGRATING_TO_3.x.html">Migrating from 2.x to 3.x</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloads.html">Downloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_pointers.html">Project pointers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_team.html">Development Team</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyTables</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">PyTables User’s Guide</a></li>
      <li class="breadcrumb-item active">Tutorials</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/usersguide/tutorials.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorials">
<h1>Tutorials<a class="headerlink" href="#tutorials" title="Link to this heading">¶</a></h1>
<blockquote class="epigraph">
<div><p>Seràs la clau que obre tots els panys,
seràs la llum, la llum il.limitada,
seràs confí on l’aurora comença,
seràs forment, escala il.luminada!</p>
<p class="attribution">—Lyrics: Vicent Andrés i Estellés. Music: Ovidi Montllor, Toti Soler, M’aclame a tu</p>
</div></blockquote>
<p>This chapter consists of a series of simple yet comprehensive
tutorials that will enable you to understand PyTables’ main features. If
you would like more information about some particular instance variable,
global function, or method, look at the doc strings or go to the library
reference in <a class="reference internal" href="libref.html#library-reference"><span class="std std-ref">Library Reference</span></a>. If you are reading this in PDF or HTML
formats, follow the corresponding hyperlink near each newly introduced
entity.</p>
<p>Please note that throughout this document the terms <em>column</em> and <em>field</em>
will be used interchangeably, as will the terms <em>row</em> and <em>record</em>.</p>
<section id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Link to this heading">¶</a></h2>
<p>In this section, we will see how to define our own records in Python and save
collections of them (i.e. a <em>table</em>) into a file. Then we will select some of
the data in the table using Python cuts and create NumPy arrays to store this
selection as separate objects in a tree.</p>
<p>In <em>examples/tutorial1-1.py</em> you will find the working version of all the
code in this section. Nonetheless, this tutorial series has been written to
allow you reproduce it in a Python interactive console. I encourage you to do
parallel testing and inspect the created objects (variables, docs, children
objects, etc.) during the course of the tutorial!</p>
<section id="importing-tables-objects">
<h3>Importing tables objects<a class="headerlink" href="#importing-tables-objects" title="Link to this heading">¶</a></h3>
<p>Before starting you need to import the public objects in the tables package.
You normally do that by executing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tables</span>
</pre></div>
</div>
<p>This is the recommended way to import tables if you don’t want to pollute
your namespace. However, PyTables has a contained set of first-level
primitives, so you may consider using the alternative:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tables</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>If you are going to work with NumPy arrays (and normally, you will) you will
also need to import functions from the numpy package. So most PyTables
programs begin with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tables</span>   <span class="c1"># but in this tutorial we use &quot;from tables import \*&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</section>
<section id="declaring-a-column-descriptor">
<h3>Declaring a Column Descriptor<a class="headerlink" href="#declaring-a-column-descriptor" title="Link to this heading">¶</a></h3>
<p>Now, imagine that we have a particle detector and we want to create a table
object in order to save data retrieved from it. You need first to define the
table, the number of columns it has, what kind of object is contained in each
column, and so on.</p>
<p>Our particle detector has a TDC (Time to Digital Converter) counter with a
dynamic range of 8 bits and an ADC (Analogical to Digital Converter) with a
range of 16 bits. For these values, we will define 2 fields in our record
object called TDCcount and ADCcount. We also want to save the grid position
in which the particle has been detected, so we will add two new fields called
grid_i and grid_j. Our instrumentation also can obtain the pressure and
energy of the particle. The resolution of the pressure-gauge allows us to use
a single-precision float to store pressure readings, while the energy value
will need a double-precision float. Finally, to track the particle we want to
assign it a name to identify the kind of the particle it is and a unique
numeric identifier. So we will add two more fields: name will be a string of
up to 16 characters, and idnumber will be an integer of 64 bits (to allow us
to store records for extremely large numbers of particles).</p>
<p>Having determined our columns and their types, we can now declare a new
Particle class that will contain all this information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tables</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Particle</span><span class="p">(</span><span class="n">IsDescription</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">name</span>      <span class="o">=</span> <span class="n">StringCol</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>   <span class="c1"># 16-character String</span>
<span class="gp">... </span>    <span class="n">idnumber</span>  <span class="o">=</span> <span class="n">Int64Col</span><span class="p">()</span>      <span class="c1"># Signed 64-bit integer</span>
<span class="gp">... </span>    <span class="n">ADCcount</span>  <span class="o">=</span> <span class="n">UInt16Col</span><span class="p">()</span>     <span class="c1"># Unsigned short integer</span>
<span class="gp">... </span>    <span class="n">TDCcount</span>  <span class="o">=</span> <span class="n">UInt8Col</span><span class="p">()</span>      <span class="c1"># unsigned byte</span>
<span class="gp">... </span>    <span class="n">grid_i</span>    <span class="o">=</span> <span class="n">Int32Col</span><span class="p">()</span>      <span class="c1"># 32-bit integer</span>
<span class="gp">... </span>    <span class="n">grid_j</span>    <span class="o">=</span> <span class="n">Int32Col</span><span class="p">()</span>      <span class="c1"># 32-bit integer</span>
<span class="gp">... </span>    <span class="n">pressure</span>  <span class="o">=</span> <span class="n">Float32Col</span><span class="p">()</span>    <span class="c1"># float  (single-precision)</span>
<span class="gp">... </span>    <span class="n">energy</span>    <span class="o">=</span> <span class="n">Float64Col</span><span class="p">()</span>    <span class="c1"># double (double-precision)</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>This definition class is self-explanatory. Basically, you declare a class
variable for each field you need. As its value you assign an instance of the
appropriate Col subclass, according to the kind of column defined (the data
type, the length, the shape, etc). See the <a class="reference internal" href="libref/declarative_classes.html#colclassdescr"><span class="std std-ref">The Col class and its descendants</span></a> for a
complete description of these subclasses. See also <a class="reference internal" href="datatypes.html#datatypes"><span class="std std-ref">Supported data types in PyTables</span></a> for a
list of data types supported by the Col constructor.</p>
<p>From now on, we can use Particle instances as a descriptor for our detector
data table. We will see later on how to pass this object to construct the
table. But first, we must create a file where all the actual data pushed into
our table will be saved.</p>
</section>
<section id="creating-a-pytables-file-from-scratch">
<h3>Creating a PyTables file from scratch<a class="headerlink" href="#creating-a-pytables-file-from-scratch" title="Link to this heading">¶</a></h3>
<p>Use the top-level <a class="reference internal" href="libref/top_level.html#tables.open_file" title="tables.open_file"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_file()</span></code></a> function to create a PyTables file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h5file</span> <span class="o">=</span> <span class="n">open_file</span><span class="p">(</span><span class="s2">&quot;tutorial1.h5&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test file&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="libref/top_level.html#tables.open_file" title="tables.open_file"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_file()</span></code></a> is one of the objects imported by the
<code class="docutils literal notranslate"><span class="pre">`from</span> <span class="pre">tables</span> <span class="pre">import</span> <span class="pre">*`</span></code> statement. Here, we are saying that we want to
create a new file in the current working directory called “tutorial1.h5” in
“w”rite mode and with a descriptive title string (“Test file”).
This function attempts to open the file, and if successful, returns the File
(see <a class="reference internal" href="libref/file_class.html#fileclassdescr"><span class="std std-ref">The File Class</span></a>) object instance h5file. The root of the object
tree is specified in the instance’s root attribute.</p>
</section>
<section id="creating-a-new-group">
<h3>Creating a new group<a class="headerlink" href="#creating-a-new-group" title="Link to this heading">¶</a></h3>
<p>Now, to better organize our data, we will create a group called <em>detector</em>
that branches from the root node. We will save our particle data table in
this group:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">group</span> <span class="o">=</span> <span class="n">h5file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s1">&#39;detector&#39;</span><span class="p">,</span> <span class="s1">&#39;Detector information&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we have taken the File instance h5file and invoked its
<a class="reference internal" href="libref/file_class.html#tables.File.create_group" title="tables.File.create_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.create_group()</span></code></a> method to create a  new group called <em>detector</em>
branching from “<em>/</em>” (another way to refer to the h5file.root object we
mentioned above). This will create a new Group (see <a class="reference internal" href="libref/hierarchy_classes.html#groupclassdescr"><span class="std std-ref">The Group class</span></a>)
object instance that will be assigned to the variable group.</p>
</section>
<section id="creating-a-new-table">
<h3>Creating a new table<a class="headerlink" href="#creating-a-new-table" title="Link to this heading">¶</a></h3>
<p>Let’s now create a Table (see <a class="reference internal" href="libref/structured_storage.html#tableclassdescr"><span class="std std-ref">The Table class</span></a>) object as a branch off
the newly-created group. We do that by calling the <a class="reference internal" href="libref/file_class.html#tables.File.create_table" title="tables.File.create_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.create_table()</span></code></a>
method of the h5file object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">h5file</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;readout&#39;</span><span class="p">,</span> <span class="n">Particle</span><span class="p">,</span> <span class="s2">&quot;Readout example&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We create the Table instance under group. We assign this table the node name
“<em>readout</em>”. The Particle class declared before is the <em>description</em>
parameter (to define the columns of the table) and finally we set
“<em>Readout example</em>” as the Table title. With all this information, a new
Table instance is created and assigned to the variable <em>table</em>.</p>
<p>If you are curious about how the object tree looks right now, simply print
the File instance variable <em>h5file</em>, and examine the output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h5file</span><span class="p">)</span>
<span class="go">tutorial1.h5 (File) &#39;Test file&#39;</span>
<span class="go">Last modif.: &#39;Wed Mar  7 11:06:12 2007&#39;</span>
<span class="go">Object Tree:</span>
<span class="go">/ (RootGroup) &#39;Test file&#39;</span>
<span class="go">/detector (Group) &#39;Detector information&#39;</span>
<span class="go">/detector/readout (Table(0,)) &#39;Readout example&#39;</span>
</pre></div>
</div>
<p>As you can see, a dump of the object tree is displayed. It’s easy to see the
Group and Table objects we have just created. If you want more information,
just type the variable containing the File instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h5file</span>
<span class="go">File(filename=&#39;tutorial1.h5&#39;, title=&#39;Test file&#39;, mode=&#39;w&#39;, root_uep=&#39;/&#39;, filters=Filters(complevel=0, shuffle=False, bitshuffle=False, fletcher32=False))</span>
<span class="go">/ (RootGroup) &#39;Test file&#39;</span>
<span class="go">/detector (Group) &#39;Detector information&#39;</span>
<span class="go">/detector/readout (Table(0,)) &#39;Readout example&#39;</span>
<span class="go">description := {</span>
<span class="go">  &quot;ADCcount&quot;: UInt16Col(shape=(), dflt=0, pos=0),</span>
<span class="go">  &quot;TDCcount&quot;: UInt8Col(shape=(), dflt=0, pos=1),</span>
<span class="go">  &quot;energy&quot;: Float64Col(shape=(), dflt=0.0, pos=2),</span>
<span class="go">  &quot;grid_i&quot;: Int32Col(shape=(), dflt=0, pos=3),</span>
<span class="go">  &quot;grid_j&quot;: Int32Col(shape=(), dflt=0, pos=4),</span>
<span class="go">  &quot;idnumber&quot;: Int64Col(shape=(), dflt=0, pos=5),</span>
<span class="go">  &quot;name&quot;: StringCol(itemsize=16, shape=(), dflt=&#39;&#39;, pos=6),</span>
<span class="go">  &quot;pressure&quot;: Float32Col(shape=(), dflt=0.0, pos=7)}</span>
<span class="go">  byteorder := &#39;little&#39;</span>
<span class="go">  chunkshape := (87,)</span>
</pre></div>
</div>
<p>More detailed information is displayed about each object in the tree. Note
how Particle, our table descriptor class, is printed as part of the <em>readout</em>
table description information. In general, you can obtain much more
information about the objects and their children by just printing them. That
introspection capability is very useful, and I recommend that you use it
extensively.</p>
<p>The time has come to fill this table with some values. First we will get a
pointer to the Row (see <a class="reference internal" href="libref/structured_storage.html#rowclassdescr"><span class="std std-ref">The Row class</span></a>) instance of this table
instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">particle</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">row</span>
</pre></div>
</div>
<p>The row attribute of table points to the Row instance that will be used to
write data rows into the table. We write data simply by assigning the Row
instance the values for each row as if it were a dictionary (although it is
actually an <em>extension class</em>), using the column names as keys.</p>
<p>Below is an example of how to write rows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Particle: </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s1">6d</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;TDCcount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">256</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;ADCcount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">256</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;grid_i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;grid_j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">-</span> <span class="n">i</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">particle</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;idnumber&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">34</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Insert a new particle record</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="o">.</span><span class="n">append</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>This code should be easy to understand. The lines inside the loop just assign
values to the different columns in the Row instance particle (see
<a class="reference internal" href="libref/structured_storage.html#rowclassdescr"><span class="std std-ref">The Row class</span></a>). A call to its append() method writes this information
to the table I/O buffer.</p>
<p>After we have processed all our data, we should flush the table’s I/O buffer
if we want to write all this data to disk. We achieve that by calling the
table.flush() method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
<p>Remember, flushing a table is a <em>very important</em> step as it will not only
help to maintain the integrity of your file, but also will free valuable
memory resources (i.e. internal buffers) that your program may need for other
things.</p>
</section>
<section id="reading-and-selecting-data-in-a-table">
<span id="readingandselectingusage"></span><h3>Reading (and selecting) data in a table<a class="headerlink" href="#reading-and-selecting-data-in-a-table" title="Link to this heading">¶</a></h3>
<p>Ok. We have our data on disk, and now we need to access it and select from
specific columns the values we are interested in. See the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">h5file</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">readout</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pressure</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;TDCcount&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="mi">20</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pressure</span>
<span class="go">[25.0, 36.0, 49.0]</span>
</pre></div>
</div>
<p>The first line creates a “shortcut” to the <em>readout</em> table deeper on the
object tree. As you can see, we use the <em>natural naming</em> schema to access it.
We also could have used the h5file.get_node() method, as we will do later on.</p>
<p>You will recognize the last two lines as a Python list comprehension.
It loops over the rows in <em>table</em> as they are provided by the
<a class="reference internal" href="libref/structured_storage.html#tables.Table.iterrows" title="tables.Table.iterrows"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.iterrows()</span></code></a> iterator. The iterator returns values until all the
data in table is exhausted. These rows are filtered using the expression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;TDCcount&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="mi">20</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">50</span>
</pre></div>
</div>
<p>So, we are selecting the values of the pressure column from filtered records
to create the final list and assign it to pressure variable.</p>
<p>We could have used a normal for loop to accomplish the same purpose, but I
find comprehension syntax to be more compact and elegant.</p>
<p>PyTables do offer other, more powerful ways of performing selections which
may be more suitable if you have very large tables or if you need very high
query speeds. They are called <em>in-kernel</em> and <em>indexed</em> queries, and you can
use them through <a class="reference internal" href="libref/structured_storage.html#tables.Table.where" title="tables.Table.where"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.where()</span></code></a> and other related methods.</p>
<p>Let’s use an in-kernel selection to query the name column for the same set of
cuts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;(TDCcount &gt; 3) &amp; (20 &lt;= pressure) &amp; (pressure &lt; 50)&quot;&quot;&quot;</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span>
<span class="go">[&#39;Particle:      5&#39;, &#39;Particle:      6&#39;, &#39;Particle:      7&#39;]</span>
</pre></div>
</div>
<p>In-kernel and indexed queries are not only much faster, but as you can see,
they also look more compact, and are among the greatest features for
PyTables, so be sure that you use them a lot. See <a class="reference internal" href="condition_syntax.html#condition-syntax"><span class="std std-ref">Condition Syntax</span></a> and
<a class="reference internal" href="optimization.html#searchoptim"><span class="std std-ref">Accelerating your searches</span></a> for more information on in-kernel and indexed selections.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A special care should be taken when the query condition includes
string literals.  Indeed Python 2 string literals are string of
bytes while Python 3 strings are unicode objects.</p>
<p>With reference to the above definition of <code class="xref py py-class docutils literal notranslate"><span class="pre">Particle</span></code> it has to be
noted that the type of the “name” column do not change depending on the
Python version used (of course).
It always corresponds to strings of bytes.</p>
<p>Any condition involving the “name” column should be written using the
appropriate type for string literals in order to avoid
<code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code>s.</p>
<p>Suppose one wants to get rows corresponding to specific particle names.</p>
<p>The code below will work fine in Python 2 but will fail with a
<code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code> in Python 3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">condition</span> <span class="o">=</span> <span class="s1">&#39;(name == &quot;Particle:      5&quot;) | (name == &quot;Particle:      7&quot;)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">condition</span><span class="p">):</span>  <span class="c1"># TypeError in Python3</span>
<span class="gp">... </span>    <span class="c1"># do something with &quot;record&quot;</span>
</pre></div>
</div>
<p>The reason is that in Python 3 “condition” implies a comparison
between a string of bytes (“name” column contents) and an unicode
literals.</p>
<p>The correct way to write the condition is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">condition</span> <span class="o">=</span> <span class="s1">&#39;(name == b&quot;Particle:      5&quot;) | (name == b&quot;Particle:      7&quot;)&#39;</span>
</pre></div>
</div>
</div>
<p>That’s enough about selections for now. The next section will show you how to
save these selected results to a file.</p>
</section>
<section id="creating-new-array-objects">
<h3>Creating new array objects<a class="headerlink" href="#creating-new-array-objects" title="Link to this heading">¶</a></h3>
<p>In order to separate the selected data from the mass of detector data, we
will create a new group columns branching off the root group. Afterwards,
under this group, we will create two arrays that will contain the selected
data. First, we create the group:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gcolumns</span> <span class="o">=</span> <span class="n">h5file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="n">h5file</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;columns&quot;</span><span class="p">,</span> <span class="s2">&quot;Pressure and Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this time we have specified the first parameter using <em>natural
naming</em> (h5file.root) instead of with an absolute path string (“/”).</p>
<p>Now, create the first of the two Array objects we’ve just mentioned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h5file</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="n">gcolumns</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pressure</span><span class="p">),</span> <span class="s2">&quot;Pressure column selection&quot;</span><span class="p">)</span>
<span class="go">/columns/pressure (Array(3,)) &#39;Pressure column selection&#39;</span>
<span class="go">  atom := Float64Atom(shape=(), dflt=0.0)</span>
<span class="go">  maindim := 0</span>
<span class="go">  flavor := &#39;numpy&#39;</span>
<span class="go">  byteorder := &#39;little&#39;</span>
<span class="go">  chunkshape := None</span>
</pre></div>
</div>
<p>We already know the first two parameters of the <a class="reference internal" href="libref/file_class.html#tables.File.create_array" title="tables.File.create_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.create_array()</span></code></a>
methods (these are the same as the first two in create_table): they are the
parent group <em>where</em> Array will be created and the Array instance <em>name</em>.
The third parameter is the <em>object</em> we want to save to disk. In this case, it
is a NumPy array that is built from the selection list we created before.
The fourth parameter is the <em>title</em>.</p>
<p>Now, we will save the second array. It contains the list of strings we
selected before: we save this object as-is, with no further conversion:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h5file</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="n">gcolumns</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="s2">&quot;Name column selection&quot;</span><span class="p">)</span>
<span class="go">/columns/name (Array(3,)) &#39;Name column selection&#39;</span>
<span class="go">  atom := StringAtom(itemsize=16, shape=(), dflt=&#39;&#39;)</span>
<span class="go">  maindim := 0</span>
<span class="go">  flavor := &#39;python&#39;</span>
<span class="go">  byteorder := &#39;irrelevant&#39;</span>
<span class="go">  chunkshape := None</span>
</pre></div>
</div>
<p>As you can see, <a class="reference internal" href="libref/file_class.html#tables.File.create_array" title="tables.File.create_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.create_array()</span></code></a> accepts <em>names</em> (which is a regular
Python list) as an <em>object</em> parameter. Actually, it accepts a variety of
different regular objects (see <code class="xref py py-func docutils literal notranslate"><span class="pre">create_array()</span></code>) as parameters. The flavor
attribute (see the output above) saves the original kind of object that was
saved. Based on this <em>flavor</em>, PyTables will be able to retrieve exactly the
same object from disk later on.</p>
<p>Note that in these examples, the create_array method returns an Array instance
that is not assigned to any variable. Don’t worry, this is intentional to
show the kind of object we have created by displaying its representation. The
Array objects have been attached to the object tree and saved to disk, as you
can see if you print the complete object tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h5file</span><span class="p">)</span>
<span class="go">tutorial1.h5 (File) &#39;Test file&#39;</span>
<span class="go">Last modif.: &#39;Wed Mar  7 19:40:44 2007&#39;</span>
<span class="go">Object Tree:</span>
<span class="go">/ (RootGroup) &#39;Test file&#39;</span>
<span class="go">/columns (Group) &#39;Pressure and Name&#39;</span>
<span class="go">/columns/name (Array(3,)) &#39;Name column selection&#39;</span>
<span class="go">/columns/pressure (Array(3,)) &#39;Pressure column selection&#39;</span>
<span class="go">/detector (Group) &#39;Detector information&#39;</span>
<span class="go">/detector/readout (Table(10,)) &#39;Readout example&#39;</span>
</pre></div>
</div>
</section>
<section id="closing-the-file-and-looking-at-its-content">
<h3>Closing the file and looking at its content<a class="headerlink" href="#closing-the-file-and-looking-at-its-content" title="Link to this heading">¶</a></h3>
<p>To finish this first tutorial, we use the close method of the h5file File
object to close the file before exiting Python:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h5file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">^</span><span class="n">D</span>
<span class="go">$</span>
</pre></div>
</div>
<p>You have now created your first PyTables file with a table and two arrays.
You can examine it with any generic HDF5 tool, such as h5dump or h5ls. Here is
what the tutorial1.h5 looks like when read with the h5ls program.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>h5ls<span class="w"> </span>-rd<span class="w"> </span>tutorial1.h5
/columns<span class="w">                 </span>Group
/columns/name<span class="w">            </span>Dataset<span class="w"> </span><span class="o">{</span><span class="m">3</span><span class="o">}</span>
<span class="w">    </span>Data:
<span class="w">        </span><span class="o">(</span><span class="m">0</span><span class="o">)</span><span class="w"> </span><span class="s2">&quot;Particle:      5&quot;</span>,<span class="w"> </span><span class="s2">&quot;Particle:      6&quot;</span>,<span class="w"> </span><span class="s2">&quot;Particle:      7&quot;</span>
/columns/pressure<span class="w">        </span>Dataset<span class="w"> </span><span class="o">{</span><span class="m">3</span><span class="o">}</span>
<span class="w">    </span>Data:
<span class="w">        </span><span class="o">(</span><span class="m">0</span><span class="o">)</span><span class="w"> </span><span class="m">25</span>,<span class="w"> </span><span class="m">36</span>,<span class="w"> </span><span class="m">49</span>
/detector<span class="w">                </span>Group
/detector/readout<span class="w">        </span>Dataset<span class="w"> </span><span class="o">{</span><span class="m">10</span>/Inf<span class="o">}</span>
<span class="w">    </span>Data:
<span class="w">        </span><span class="o">(</span><span class="m">0</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="m">0</span>,<span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="m">10</span>,<span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="s2">&quot;Particle:      0&quot;</span>,<span class="w"> </span><span class="m">0</span><span class="o">}</span>,
<span class="w">        </span><span class="o">(</span><span class="m">1</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="m">256</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">9</span>,<span class="w"> </span><span class="m">17179869184</span>,<span class="w"> </span><span class="s2">&quot;Particle:      1&quot;</span>,<span class="w"> </span><span class="m">1</span><span class="o">}</span>,
<span class="w">        </span><span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="m">512</span>,<span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="m">256</span>,<span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="m">8</span>,<span class="w"> </span><span class="m">34359738368</span>,<span class="w"> </span><span class="s2">&quot;Particle:      2&quot;</span>,<span class="w"> </span><span class="m">4</span><span class="o">}</span>,
<span class="w">        </span><span class="o">(</span><span class="m">3</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="m">768</span>,<span class="w"> </span><span class="m">3</span>,<span class="w"> </span><span class="m">6561</span>,<span class="w"> </span><span class="m">3</span>,<span class="w"> </span><span class="m">7</span>,<span class="w"> </span><span class="m">51539607552</span>,<span class="w"> </span><span class="s2">&quot;Particle:      3&quot;</span>,<span class="w"> </span><span class="m">9</span><span class="o">}</span>,
<span class="w">        </span><span class="o">(</span><span class="m">4</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="m">1024</span>,<span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="m">65536</span>,<span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="m">6</span>,<span class="w"> </span><span class="m">68719476736</span>,<span class="w"> </span><span class="s2">&quot;Particle:      4&quot;</span>,<span class="w"> </span><span class="m">16</span><span class="o">}</span>,
<span class="w">        </span><span class="o">(</span><span class="m">5</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="m">1280</span>,<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">390625</span>,<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">85899345920</span>,<span class="w"> </span><span class="s2">&quot;Particle:      5&quot;</span>,<span class="w"> </span><span class="m">25</span><span class="o">}</span>,
<span class="w">        </span><span class="o">(</span><span class="m">6</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="m">1536</span>,<span class="w"> </span><span class="m">6</span>,<span class="w"> </span><span class="m">1679616</span>,<span class="w"> </span><span class="m">6</span>,<span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="m">103079215104</span>,<span class="w"> </span><span class="s2">&quot;Particle:      6&quot;</span>,<span class="w"> </span><span class="m">36</span><span class="o">}</span>,
<span class="w">        </span><span class="o">(</span><span class="m">7</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="m">1792</span>,<span class="w"> </span><span class="m">7</span>,<span class="w"> </span><span class="m">5764801</span>,<span class="w"> </span><span class="m">7</span>,<span class="w"> </span><span class="m">3</span>,<span class="w"> </span><span class="m">120259084288</span>,<span class="w"> </span><span class="s2">&quot;Particle:      7&quot;</span>,<span class="w"> </span><span class="m">49</span><span class="o">}</span>,
<span class="w">        </span><span class="o">(</span><span class="m">8</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="m">2048</span>,<span class="w"> </span><span class="m">8</span>,<span class="w"> </span><span class="m">16777216</span>,<span class="w"> </span><span class="m">8</span>,<span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="m">137438953472</span>,<span class="w"> </span><span class="s2">&quot;Particle:      8&quot;</span>,<span class="w"> </span><span class="m">64</span><span class="o">}</span>,
<span class="w">        </span><span class="o">(</span><span class="m">9</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="m">2304</span>,<span class="w"> </span><span class="m">9</span>,<span class="w"> </span><span class="m">43046721</span>,<span class="w"> </span><span class="m">9</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">154618822656</span>,<span class="w"> </span><span class="s2">&quot;Particle:      9&quot;</span>,<span class="w"> </span><span class="m">81</span><span class="o">}</span>
</pre></div>
</div>
<p>Here’s the output as displayed by the “ptdump” PyTables utility (located in
utils/ directory).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ptdump<span class="w"> </span>tutorial1.h5
/<span class="w"> </span><span class="o">(</span>RootGroup<span class="o">)</span><span class="w"> </span><span class="s1">&#39;Test file&#39;</span>
/columns<span class="w"> </span><span class="o">(</span>Group<span class="o">)</span><span class="w"> </span><span class="s1">&#39;Pressure and Name&#39;</span>
/columns/name<span class="w"> </span><span class="o">(</span>Array<span class="o">(</span><span class="m">3</span>,<span class="o">))</span><span class="w"> </span><span class="s1">&#39;Name column selection&#39;</span>
/columns/pressure<span class="w"> </span><span class="o">(</span>Array<span class="o">(</span><span class="m">3</span>,<span class="o">))</span><span class="w"> </span><span class="s1">&#39;Pressure column selection&#39;</span>
/detector<span class="w"> </span><span class="o">(</span>Group<span class="o">)</span><span class="w"> </span><span class="s1">&#39;Detector information&#39;</span>
/detector/readout<span class="w"> </span><span class="o">(</span>Table<span class="o">(</span><span class="m">10</span>,<span class="o">))</span><span class="w"> </span><span class="s1">&#39;Readout example&#39;</span>
</pre></div>
</div>
<p>You can pass the <cite>-v</cite> or <cite>-d</cite> options to ptdump if you want
more verbosity. Try them out!</p>
<p>Also, in <a class="reference internal" href="#tutorial1-1-tableview"><span class="std std-ref">Figure 1</span></a>, you can admire how the
tutorial1.h5 looks like using the <a class="reference external" href="http://vitables.org">ViTables</a> graphical
interface.</p>
<figure class="align-center" id="id9">
<span id="tutorial1-1-tableview"></span><img alt="../_images/tutorial1-1-tableview.png" src="../_images/tutorial1-1-tableview.png" />
<figcaption>
<p><span class="caption-text"><strong>Figure 1. The initial version of the data file for tutorial 1, with a
view of the data objects.</strong></span><a class="headerlink" href="#id9" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="browsing-the-object-tree">
<h2>Browsing the <em>object tree</em><a class="headerlink" href="#browsing-the-object-tree" title="Link to this heading">¶</a></h2>
<p>In this section, we will learn how to browse the tree and retrieve data and
also meta-information about the actual data.</p>
<p>In <em>examples/tutorial1-2.py</em> you will find the working version of all the
code in this section. As before, you are encouraged to use a python shell and
inspect the object tree during the course of the tutorial.</p>
<section id="traversing-the-object-tree">
<h3>Traversing the object tree<a class="headerlink" href="#traversing-the-object-tree" title="Link to this heading">¶</a></h3>
<p>Let’s start by opening the file we created in last tutorial section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h5file</span> <span class="o">=</span> <span class="n">open_file</span><span class="p">(</span><span class="s2">&quot;tutorial1.h5&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This time, we have opened the file in “a”ppend mode. We use this mode to add
more information to the file.</p>
<p>PyTables, following the Python tradition, offers powerful introspection
capabilities, i.e. you can easily ask information about any component of the
object tree as well as search the tree.</p>
<p>To start with, you can get a preliminary overview of the object tree by
simply printing the existing File instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h5file</span><span class="p">)</span>
<span class="go">tutorial1.h5 (File) &#39;Test file&#39;</span>
<span class="go">Last modif.: &#39;Wed Mar  7 19:50:57 2007&#39;</span>
<span class="go">Object Tree:</span>
<span class="go">/ (RootGroup) &#39;Test file&#39;</span>
<span class="go">/columns (Group) &#39;Pressure and Name&#39;</span>
<span class="go">/columns/name (Array(3,)) &#39;Name column selection&#39;</span>
<span class="go">/columns/pressure (Array(3,)) &#39;Pressure column selection&#39;</span>
<span class="go">/detector (Group) &#39;Detector information&#39;</span>
<span class="go">/detector/readout (Table(10,)) &#39;Readout example&#39;</span>
</pre></div>
</div>
<p>It looks like all of our objects are there. Now let’s make use of the File
iterator to see how to list all the nodes in the object tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">h5file</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<span class="go">/ (RootGroup) &#39;Test file&#39;</span>
<span class="go">/columns (Group) &#39;Pressure and Name&#39;</span>
<span class="go">/detector (Group) &#39;Detector information&#39;</span>
<span class="go">/columns/name (Array(3,)) &#39;Name column selection&#39;</span>
<span class="go">/columns/pressure (Array(3,)) &#39;Pressure column selection&#39;</span>
<span class="go">/detector/readout (Table(10,)) &#39;Readout example&#39;</span>
</pre></div>
</div>
<p>We can use the <a class="reference internal" href="libref/file_class.html#tables.File.walk_groups" title="tables.File.walk_groups"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.walk_groups()</span></code></a> method of the File class to list only
the <em>groups</em> on tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">h5file</span><span class="o">.</span><span class="n">walk_groups</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
<span class="go">/ (RootGroup) &#39;Test file&#39;</span>
<span class="go">/columns (Group) &#39;Pressure and Name&#39;</span>
<span class="go">/detector (Group) &#39;Detector information&#39;</span>
</pre></div>
</div>
<p>Note that <a class="reference internal" href="libref/file_class.html#tables.File.walk_groups" title="tables.File.walk_groups"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.walk_groups()</span></code></a> actually returns an <em>iterator</em>, not a list
of objects. Using this iterator with the list_nodes() method is a powerful
combination. Let’s see an example listing of all the arrays in the tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">h5file</span><span class="o">.</span><span class="n">walk_groups</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">array</span> <span class="ow">in</span> <span class="n">h5file</span><span class="o">.</span><span class="n">list_nodes</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s1">&#39;Array&#39;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<span class="go">/columns/name (Array(3,)) &#39;Name column selection&#39;</span>
<span class="go">/columns/pressure (Array(3,)) &#39;Pressure column selection&#39;</span>
</pre></div>
</div>
<p><a class="reference internal" href="libref/file_class.html#tables.File.list_nodes" title="tables.File.list_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.list_nodes()</span></code></a> returns a list containing all the nodes hanging off a
specific Group. If the <em>classname</em> keyword is specified, the method will
filter out all instances which are not descendants of the class. We have
asked for only Array instances. There exist also an iterator counterpart
called <a class="reference internal" href="libref/file_class.html#tables.File.iter_nodes" title="tables.File.iter_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.iter_nodes()</span></code></a> that might be handy is some situations, like
for example when dealing with groups with a large number of nodes behind it.</p>
<p>We can combine both calls by using the <a class="reference internal" href="libref/file_class.html#tables.File.walk_nodes" title="tables.File.walk_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.walk_nodes()</span></code></a> special method
of the File object. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">array</span> <span class="ow">in</span> <span class="n">h5file</span><span class="o">.</span><span class="n">walk_nodes</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;Array&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<span class="go">/columns/name (Array(3,)) &#39;Name column selection&#39;</span>
<span class="go">/columns/pressure (Array(3,)) &#39;Pressure column selection&#39;</span>
</pre></div>
</div>
<p>This is a nice shortcut when working interactively.</p>
<p>Finally, we will list all the Leaf, i.e. Table and Array instances (see
<a class="reference internal" href="libref/hierarchy_classes.html#leafclassdescr"><span class="std std-ref">The Leaf class</span></a> for detailed information on Leaf class), in the
/detector group. Note that only one instance of the Table class (i.e.
readout) will be selected in this group (as should be the case):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">h5file</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">_f_walknodes</span><span class="p">(</span><span class="s1">&#39;Leaf&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
<span class="go">/detector/readout (Table(10,)) &#39;Readout example&#39;</span>
</pre></div>
</div>
<p>We have used a call to the <a class="reference internal" href="libref/hierarchy_classes.html#tables.Group._f_walknodes" title="tables.Group._f_walknodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Group._f_walknodes()</span></code></a> method, using the
<em>natural naming</em> path specification.</p>
<p>Of course you can do more sophisticated node selections using these powerful
methods. But first, let’s take a look at some important PyTables object
instance variables.</p>
</section>
<section id="setting-and-getting-user-attributes">
<h3>Setting and getting user attributes<a class="headerlink" href="#setting-and-getting-user-attributes" title="Link to this heading">¶</a></h3>
<p>PyTables provides an easy and concise way to complement the meaning of your
node objects on the tree by using the AttributeSet class (see
<a class="reference internal" href="libref/declarative_classes.html#attributesetclassdescr"><span class="std std-ref">The AttributeSet class</span></a>). You can access this object through the
standard attribute attrs in Leaf nodes and _v_attrs in Group nodes.</p>
<p>For example, let’s imagine that we want to save the date indicating when the
data in /detector/readout table has been acquired, as well as the temperature
during the gathering process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">h5file</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">readout</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">gath_date</span> <span class="o">=</span> <span class="s2">&quot;Wed, 06/12/2003 18:33&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">18.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">temp_scale</span> <span class="o">=</span> <span class="s2">&quot;Celsius&quot;</span>
</pre></div>
</div>
<p>Now, let’s set a somewhat more complex attribute in the /detector group:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">detector</span> <span class="o">=</span> <span class="n">h5file</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">detector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detector</span><span class="o">.</span><span class="n">_v_attrs</span><span class="o">.</span><span class="n">stuff</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span> <span class="s2">&quot;Integer and tuple&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Note how the AttributeSet instance is accessed with the _v_attrs attribute
because detector is a Group node. In general, you can save any standard
Python data structure as an attribute node. See <a class="reference internal" href="libref/declarative_classes.html#attributesetclassdescr"><span class="std std-ref">The AttributeSet class</span></a>
for a more detailed explanation of how they are serialized for export to
disk.</p>
<p>Retrieving the attributes is equally simple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">gath_date</span>
<span class="go">&#39;Wed, 06/12/2003 18:33&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">temperature</span>
<span class="go">18.399999999999999</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">temp_scale</span>
<span class="go">&#39;Celsius&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detector</span><span class="o">.</span><span class="n">_v_attrs</span><span class="o">.</span><span class="n">stuff</span>
<span class="go">[5, (2.2999999999999998, 4.5), &#39;Integer and tuple&#39;]</span>
</pre></div>
</div>
<p>You can probably guess how to delete attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">gath_date</span>
</pre></div>
</div>
<p>If you want to examine the current user attribute set of /detector/table, you
can print its representation (try hitting the TAB key twice if you are on a
Unix Python console with the rlcompleter module active):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span>
<span class="go">/detector/readout._v_attrs (AttributeSet), 23 attributes:</span>
<span class="go">    [CLASS := &#39;TABLE&#39;,</span>
<span class="go">     FIELD_0_FILL := 0,</span>
<span class="go">     FIELD_0_NAME := &#39;ADCcount&#39;,</span>
<span class="go">     FIELD_1_FILL := 0,</span>
<span class="go">     FIELD_1_NAME := &#39;TDCcount&#39;,</span>
<span class="go">     FIELD_2_FILL := 0.0,</span>
<span class="go">     FIELD_2_NAME := &#39;energy&#39;,</span>
<span class="go">     FIELD_3_FILL := 0,</span>
<span class="go">     FIELD_3_NAME := &#39;grid_i&#39;,</span>
<span class="go">     FIELD_4_FILL := 0,</span>
<span class="go">     FIELD_4_NAME := &#39;grid_j&#39;,</span>
<span class="go">     FIELD_5_FILL := 0,</span>
<span class="go">     FIELD_5_NAME := &#39;idnumber&#39;,</span>
<span class="go">     FIELD_6_FILL := &#39;&#39;,</span>
<span class="go">     FIELD_6_NAME := &#39;name&#39;,</span>
<span class="go">     FIELD_7_FILL := 0.0,</span>
<span class="go">     FIELD_7_NAME := &#39;pressure&#39;,</span>
<span class="go">     FLAVOR := &#39;numpy&#39;,</span>
<span class="go">     NROWS := 10,</span>
<span class="go">     TITLE := &#39;Readout example&#39;,</span>
<span class="go">     VERSION := &#39;2.6&#39;,</span>
<span class="go">     temp_scale := &#39;Celsius&#39;,</span>
<span class="go">     temperature := 18.399999999999999]</span>
</pre></div>
</div>
<p>We’ve got all the attributes (including the <em>system</em> attributes). You can get
a list of <em>all</em> attributes or only the <em>user</em> or <em>system</em> attributes with the
_f_list() method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">_f_list</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">))</span>
<span class="go">[&#39;CLASS&#39;, &#39;FIELD_0_FILL&#39;, &#39;FIELD_0_NAME&#39;, &#39;FIELD_1_FILL&#39;, &#39;FIELD_1_NAME&#39;,</span>
<span class="go">&#39;FIELD_2_FILL&#39;, &#39;FIELD_2_NAME&#39;, &#39;FIELD_3_FILL&#39;, &#39;FIELD_3_NAME&#39;, &#39;FIELD_4_FILL&#39;,</span>
<span class="go">&#39;FIELD_4_NAME&#39;, &#39;FIELD_5_FILL&#39;, &#39;FIELD_5_NAME&#39;, &#39;FIELD_6_FILL&#39;, &#39;FIELD_6_NAME&#39;,</span>
<span class="go">&#39;FIELD_7_FILL&#39;, &#39;FIELD_7_NAME&#39;, &#39;FLAVOR&#39;, &#39;NROWS&#39;, &#39;TITLE&#39;, &#39;VERSION&#39;,</span>
<span class="go">&#39;temp_scale&#39;, &#39;temperature&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">_f_list</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">))</span>
<span class="go">[&#39;temp_scale&#39;, &#39;temperature&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">_f_list</span><span class="p">(</span><span class="s2">&quot;sys&quot;</span><span class="p">))</span>
<span class="go">[&#39;CLASS&#39;, &#39;FIELD_0_FILL&#39;, &#39;FIELD_0_NAME&#39;, &#39;FIELD_1_FILL&#39;, &#39;FIELD_1_NAME&#39;,</span>
<span class="go">&#39;FIELD_2_FILL&#39;, &#39;FIELD_2_NAME&#39;, &#39;FIELD_3_FILL&#39;, &#39;FIELD_3_NAME&#39;, &#39;FIELD_4_FILL&#39;,</span>
<span class="go">&#39;FIELD_4_NAME&#39;, &#39;FIELD_5_FILL&#39;, &#39;FIELD_5_NAME&#39;, &#39;FIELD_6_FILL&#39;, &#39;FIELD_6_NAME&#39;,</span>
<span class="go">&#39;FIELD_7_FILL&#39;, &#39;FIELD_7_NAME&#39;, &#39;FLAVOR&#39;, &#39;NROWS&#39;, &#39;TITLE&#39;, &#39;VERSION&#39;]</span>
</pre></div>
</div>
<p>You can also rename attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">_f_rename</span><span class="p">(</span><span class="s2">&quot;temp_scale&quot;</span><span class="p">,</span><span class="s2">&quot;tempScale&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">_f_list</span><span class="p">())</span>
<span class="go">[&#39;tempScale&#39;, &#39;temperature&#39;]</span>
</pre></div>
</div>
<p>And, from PyTables 2.0 on, you are allowed also to set, delete or rename
system attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">_f_rename</span><span class="p">(</span><span class="s2">&quot;VERSION&quot;</span><span class="p">,</span> <span class="s2">&quot;version&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">VERSION</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;tables/attributeset.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">222</span><span class="p">,</span> <span class="ow">in</span> <span class="fm">__getattr__</span>
<span class="w">    </span>    <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v__nodepath</span><span class="p">)</span>
<span class="gr">AttributeError</span>: <span class="n">Attribute &#39;VERSION&#39; does not exist in node: &#39;/detector/readout&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">version</span>
<span class="go">&#39;2.6&#39;</span>
</pre></div>
</div>
<p><em>Caveat emptor:</em> you must be careful when modifying system attributes because
you may end fooling PyTables and ultimately getting unwanted behaviour. Use
this only if you know what are you doing.</p>
<p>So, given the caveat above, we will proceed to restore the original name of
VERSION attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">_f_rename</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">,</span> <span class="s2">&quot;VERSION&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">VERSION</span>
<span class="go">&#39;2.6&#39;</span>
</pre></div>
</div>
<p>Ok, that’s better. If you would terminate your session now, you would be able
to use the h5ls command to read the /detector/readout attributes from the
file written to disk.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>h5ls<span class="w"> </span>-vr<span class="w"> </span>tutorial1.h5/detector/readout
Opened<span class="w"> </span><span class="s2">&quot;tutorial1.h5&quot;</span><span class="w"> </span>with<span class="w"> </span>sec2<span class="w"> </span>driver.
/detector/readout<span class="w">        </span>Dataset<span class="w"> </span><span class="o">{</span><span class="m">10</span>/Inf<span class="o">}</span>
<span class="w">    </span>Attribute:<span class="w"> </span>CLASS<span class="w">     </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">6</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;TABLE&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>VERSION<span class="w">   </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">4</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;2.6&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>TITLE<span class="w">     </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">16</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;Readout example&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>NROWS<span class="w">     </span>scalar
<span class="w">        </span>Type:<span class="w">      </span>native<span class="w"> </span>long<span class="w"> </span>long
<span class="w">        </span>Data:<span class="w">  </span><span class="m">10</span>
<span class="w">    </span>Attribute:<span class="w"> </span>FIELD_0_NAME<span class="w"> </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">9</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;ADCcount&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>FIELD_1_NAME<span class="w"> </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">9</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;TDCcount&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>FIELD_2_NAME<span class="w"> </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">7</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;energy&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>FIELD_3_NAME<span class="w"> </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">7</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;grid_i&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>FIELD_4_NAME<span class="w"> </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">7</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;grid_j&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>FIELD_5_NAME<span class="w"> </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">9</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;idnumber&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>FIELD_6_NAME<span class="w"> </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">5</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;name&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>FIELD_7_NAME<span class="w"> </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">9</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;pressure&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>FLAVOR<span class="w">    </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">5</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;numpy&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>tempScale<span class="w"> </span>scalar
<span class="w">        </span>Type:<span class="w">      </span><span class="m">7</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">        </span>Data:<span class="w">  </span><span class="s2">&quot;Celsius&quot;</span>
<span class="w">    </span>Attribute:<span class="w"> </span>temperature<span class="w"> </span>scalar
<span class="w">        </span>Type:<span class="w">      </span>native<span class="w"> </span>double
<span class="w">        </span>Data:<span class="w">  </span><span class="m">18</span>.4
<span class="w">    </span>Location:<span class="w">  </span><span class="m">0</span>:1:0:1952
<span class="w">    </span>Links:<span class="w">     </span><span class="m">1</span>
<span class="w">    </span>Modified:<span class="w">  </span><span class="m">2006</span>-12-11<span class="w"> </span><span class="m">10</span>:35:13<span class="w"> </span>CET
<span class="w">    </span>Chunks:<span class="w">    </span><span class="o">{</span><span class="m">85</span><span class="o">}</span><span class="w"> </span><span class="m">3995</span><span class="w"> </span>bytes
<span class="w">    </span>Storage:<span class="w">   </span><span class="m">470</span><span class="w"> </span>logical<span class="w"> </span>bytes,<span class="w"> </span><span class="m">3995</span><span class="w"> </span>allocated<span class="w"> </span>bytes,<span class="w"> </span><span class="m">11</span>.76%<span class="w"> </span>utilization
<span class="w">    </span>Type:<span class="w">      </span>struct<span class="w"> </span><span class="o">{</span>
<span class="w">                    </span><span class="s2">&quot;ADCcount&quot;</span><span class="w">         </span>+0<span class="w">    </span>native<span class="w"> </span>unsigned<span class="w"> </span>short
<span class="w">                    </span><span class="s2">&quot;TDCcount&quot;</span><span class="w">         </span>+2<span class="w">    </span>native<span class="w"> </span>unsigned<span class="w"> </span>char
<span class="w">                    </span><span class="s2">&quot;energy&quot;</span><span class="w">           </span>+3<span class="w">    </span>native<span class="w"> </span>double
<span class="w">                    </span><span class="s2">&quot;grid_i&quot;</span><span class="w">           </span>+11<span class="w">   </span>native<span class="w"> </span>int
<span class="w">                    </span><span class="s2">&quot;grid_j&quot;</span><span class="w">           </span>+15<span class="w">   </span>native<span class="w"> </span>int
<span class="w">                    </span><span class="s2">&quot;idnumber&quot;</span><span class="w">         </span>+19<span class="w">   </span>native<span class="w"> </span>long<span class="w"> </span>long
<span class="w">                    </span><span class="s2">&quot;name&quot;</span><span class="w">             </span>+27<span class="w">   </span><span class="m">16</span>-byte<span class="w"> </span>null-terminated<span class="w"> </span>ASCII<span class="w"> </span>string
<span class="w">                    </span><span class="s2">&quot;pressure&quot;</span><span class="w">         </span>+43<span class="w">   </span>native<span class="w"> </span>float
<span class="w">                </span><span class="o">}</span><span class="w"> </span><span class="m">47</span><span class="w"> </span>bytes
</pre></div>
</div>
<p>Attributes are a useful mechanism to add persistent (meta) information to
your data.</p>
<p>Starting with PyTables 3.9.0, you can also set, delete, or rename attributes on individual columns. The API is designed to behave the same way as attributes on a table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;kPa&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;MeV&#39;</span>
</pre></div>
</div>
</section>
<section id="getting-object-metadata">
<h3>Getting object metadata<a class="headerlink" href="#getting-object-metadata" title="Link to this heading">¶</a></h3>
<p>Each object in PyTables has <em>metadata</em> information about the data in the
file. Normally this <em>meta-information</em> is accessible through the node
instance variables. Let’s take a look at some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Object:&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<span class="go">Object: /detector/readout (Table(10,)) &#39;Readout example&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Table name:&quot;</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">Table name: readout</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Table title:&quot;</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
<span class="go">Table title: Readout example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of rows in table:&quot;</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
<span class="go">Number of rows in table: 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Table variable names with their type and shape:&quot;</span><span class="p">)</span>
<span class="go">Table variable names with their type and shape:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">colnames</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;:= </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">coldtypes</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">table</span><span class="o">.</span><span class="n">coldtypes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="go">ADCcount := uint16, ()</span>
<span class="go">TDCcount := uint8, ()</span>
<span class="go">energy := float64, ()</span>
<span class="go">grid_i := int32, ()</span>
<span class="go">grid_j := int32, ()</span>
<span class="go">idnumber := int64, ()</span>
<span class="go">name := |S16, ()</span>
<span class="go">pressure := float32, ()</span>
</pre></div>
</div>
<p>Here, the name, title, nrows, colnames and coldtypes attributes (see
<a class="reference internal" href="libref/structured_storage.html#tables.Table" title="tables.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> for a complete attribute list) of the Table object gives us
quite a bit of information about the table data.</p>
<p>You can interactively retrieve general information about the public objects
in PyTables by asking for help:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="go">Help on Table in module tables.table:</span>
<span class="go">class Table(tableextension.Table, tables.leaf.Leaf)</span>
<span class="go">|  This class represents heterogeneous datasets in an HDF5 file.</span>
<span class="go">|</span>
<span class="go">|  Tables are leaves (see the `Leaf` class) whose data consists of a</span>
<span class="go">|  unidimensional sequence of *rows*, where each row contains one or</span>
<span class="go">|  more *fields*.  Fields have an associated unique *name* and</span>
<span class="go">|  *position*, with the first field having position 0.  All rows have</span>
<span class="go">|  the same fields, which are arranged in *columns*.</span>
<span class="go">[snip]</span>
<span class="go">|</span>
<span class="go">|  Instance variables</span>
<span class="go">|  ------------------</span>
<span class="go">|</span>
<span class="go">|  The following instance variables are provided in addition to those</span>
<span class="go">|  in `Leaf`.  Please note that there are several `col` dictionaries</span>
<span class="go">|  to ease retrieving information about a column directly by its path</span>
<span class="go">|  name, avoiding the need to walk through `Table.description` or</span>
<span class="go">|  `Table.cols`.</span>
<span class="go">|</span>
<span class="go">|  autoindex</span>
<span class="go">|      Automatically keep column indexes up to date?</span>
<span class="go">|</span>
<span class="go">|      Setting this value states whether existing indexes should be</span>
<span class="go">|      automatically updated after an append operation or recomputed</span>
<span class="go">|      after an index-invalidating operation (i.e. removal and</span>
<span class="go">|      modification of rows).  The default is true.</span>
<span class="go">[snip]</span>
<span class="go">|  rowsize</span>
<span class="go">|      The size in bytes of each row in the table.</span>
<span class="go">|</span>
<span class="go">|  Public methods -- reading</span>
<span class="go">|  -------------------------</span>
<span class="go">|</span>
<span class="go">|  * col(name)</span>
<span class="go">|  * iterrows([start][, stop][, step])</span>
<span class="go">|  * itersequence(sequence)</span>
<span class="go">* itersorted(sortby[, checkCSI][, start][, stop][, step])</span>
<span class="go">|  * read([start][, stop][, step][, field][, coords])</span>
<span class="go">|  * read_coordinates(coords[, field])</span>
<span class="go">* read_sorted(sortby[, checkCSI][, field,][, start][, stop][, step])</span>
<span class="go">|  * __getitem__(key)</span>
<span class="go">|  * __iter__()</span>
<span class="go">|</span>
<span class="go">|  Public methods -- writing</span>
<span class="go">|  -------------------------</span>
<span class="go">|</span>
<span class="go">|  * append(rows)</span>
<span class="go">|  * modify_column([start][, stop][, step][, column][, colname])</span>
<span class="go">[snip]</span>
</pre></div>
</div>
<p>Try getting help with other object docs by yourself:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">h5file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">remove_rows</span><span class="p">)</span>
</pre></div>
</div>
<p>To examine metadata in the <em>/columns/pressure</em> Array object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pressureObject</span> <span class="o">=</span> <span class="n">h5file</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s2">&quot;/columns&quot;</span><span class="p">,</span> <span class="s2">&quot;pressure&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Info on the object:&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pressureObject</span><span class="p">))</span>
<span class="go">Info on the object: /columns/pressure (Array(3,)) &#39;Pressure column selection&#39;</span>
<span class="go">  atom := Float64Atom(shape=(), dflt=0.0)</span>
<span class="go">  maindim := 0</span>
<span class="go">  flavor := &#39;numpy&#39;</span>
<span class="go">  byteorder := &#39;little&#39;</span>
<span class="go">  chunkshape := None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  shape: ==&gt;&quot;</span><span class="p">,</span> <span class="n">pressureObject</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">  shape: ==&gt; (3,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  title: ==&gt;&quot;</span><span class="p">,</span> <span class="n">pressureObject</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
<span class="go">  title: ==&gt; Pressure column selection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  atom: ==&gt;&quot;</span><span class="p">,</span> <span class="n">pressureObject</span><span class="o">.</span><span class="n">atom</span><span class="p">)</span>
<span class="go">  atom: ==&gt; Float64Atom(shape=(), dflt=0.0)</span>
</pre></div>
</div>
<p>Observe that we have used the <a class="reference internal" href="libref/file_class.html#tables.File.get_node" title="tables.File.get_node"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.get_node()</span></code></a> method of the File class
to access a node in the tree, instead of the natural naming method. Both are
useful, and depending on the context you will prefer one or the other.
<a class="reference internal" href="libref/file_class.html#tables.File.get_node" title="tables.File.get_node"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.get_node()</span></code></a> has the advantage that it can get a node from the
pathname string (as in this example) and can also act as a filter to show
only nodes in a particular location that are instances of class <em>classname</em>.
In general, however, I consider natural naming to be more elegant and easier
to use, especially if you are using the name completion capability present in
interactive console. Try this powerful combination of natural naming and
completion capabilities present in most Python consoles, and see how pleasant
it is to browse the object tree (well, as pleasant as such an activity can
be).</p>
<p>If you look at the type attribute of the pressureObject object, you can
verify that it is a “<em>float64</em>” array. By looking at its shape attribute, you
can deduce that the array on disk is unidimensional and has 3 elements.
See <a class="reference internal" href="libref/homogenous_storage.html#tables.Array" title="tables.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> or the internal doc strings for the complete Array
attribute list.</p>
</section>
<section id="reading-data-from-array-objects">
<h3>Reading data from Array objects<a class="headerlink" href="#reading-data-from-array-objects" title="Link to this heading">¶</a></h3>
<p>Once you have found the desired Array, use the read() method of the Array
object to retrieve its data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pressureArray</span> <span class="o">=</span> <span class="n">pressureObject</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pressureArray</span>
<span class="go">array([ 25.,  36.,  49.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pressureArray is an object of type:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">pressureArray</span><span class="p">))</span>
<span class="go">pressureArray is an object of type: &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nameArray</span> <span class="o">=</span> <span class="n">h5file</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nameArray is an object of type:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">nameArray</span><span class="p">))</span>
<span class="go">nameArray is an object of type: &lt;type &#39;list&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data on arrays nameArray and pressureArray:&quot;</span><span class="p">)</span>
<span class="go">Data on arrays nameArray and pressureArray:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pressureObject</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">nameArray</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;--&gt;&quot;</span><span class="p">,</span> <span class="n">pressureArray</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="go">Particle:      5 --&gt; 25.0</span>
<span class="go">Particle:      6 --&gt; 36.0</span>
<span class="go">Particle:      7 --&gt; 49.0</span>
</pre></div>
</div>
<p>You can see that the <a class="reference internal" href="libref/homogenous_storage.html#tables.Array.read" title="tables.Array.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Array.read()</span></code></a> method returns an authentic NumPy
object for the pressureObject instance by looking at the output of the type()
call. A read() of the nameArray object instance returns a native Python list
(of strings). The type of the object saved is stored as an HDF5 attribute
(named FLAVOR) for objects on disk. This attribute is then read as Array
meta-information (accessible through in the Array.attrs.FLAVOR variable),
enabling the read array to be converted into the original object. This
provides a means to save a large variety of objects as arrays with the
guarantee that you will be able to later recover them in their original form.
See <a class="reference internal" href="libref/file_class.html#tables.File.create_array" title="tables.File.create_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.create_array()</span></code></a> for a complete list of supported objects for the
Array object class.</p>
</section>
</section>
<section id="commiting-data-to-tables-and-arrays">
<h2>Commiting data to tables and arrays<a class="headerlink" href="#commiting-data-to-tables-and-arrays" title="Link to this heading">¶</a></h2>
<p>We have seen how to create tables and arrays and how to browse both data and
metadata in the object tree. Let’s examine more closely now one of the most
powerful capabilities of PyTables, namely, how to modify already created
tables and arrays <a class="footnote-reference brackets" href="#id5" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
<section id="appending-data-to-an-existing-table">
<h3>Appending data to an existing table<a class="headerlink" href="#appending-data-to-an-existing-table" title="Link to this heading">¶</a></h3>
<p>Now, let’s have a look at how we can add records to an existing table on
disk. Let’s use our well-known <em>readout</em> Table object and append some new
values to it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">h5file</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">readout</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">particle</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Particle: </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s1">6d</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;TDCcount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">256</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;ADCcount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">256</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;grid_i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;grid_j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">-</span> <span class="n">i</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">particle</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;idnumber&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">34</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">particle</span><span class="o">.</span><span class="n">append</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
<p>It’s the same method we used to fill a new table. PyTables knows that this
table is on disk, and when you add new records, they are appended to the end
of the table <a class="footnote-reference brackets" href="#id6" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<p>If you look carefully at the code you will see that we have used the
table.row attribute to create a table row and fill it with the new values.
Each time that its append() method is called, the actual row is committed to
the output buffer and the row pointer is incremented to point to the next
table record. When the buffer is full, the data is saved on disk, and the
buffer is reused again for the next cycle.</p>
<p><em>Caveat emptor</em>: Do not forget to always call the flush() method after a
write operation, or else your tables will not be updated!</p>
<p>Let’s have a look at some rows in the modified table and verify that our new
data has been appended:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-16s</span><span class="s2"> | </span><span class="si">%11.1f</span><span class="s2"> | </span><span class="si">%11.4g</span><span class="s2"> | </span><span class="si">%6d</span><span class="s2"> | </span><span class="si">%6d</span><span class="s2"> | </span><span class="si">%8d</span><span class="s2"> \|&quot;</span> <span class="o">%</span> \\
<span class="gp">... </span>        <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;grid_i&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;grid_j&#39;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;TDCcount&#39;</span><span class="p">]))</span>
<span class="go">Particle:      0 |         0.0 |           0 |      0 |     10 |        0 |</span>
<span class="go">Particle:      1 |         1.0 |           1 |      1 |      9 |        1 |</span>
<span class="go">Particle:      2 |         4.0 |         256 |      2 |      8 |        2 |</span>
<span class="go">Particle:      3 |         9.0 |        6561 |      3 |      7 |        3 |</span>
<span class="go">Particle:      4 |        16.0 |   6.554e+04 |      4 |      6 |        4 |</span>
<span class="go">Particle:      5 |        25.0 |   3.906e+05 |      5 |      5 |        5 |</span>
<span class="go">Particle:      6 |        36.0 |    1.68e+06 |      6 |      4 |        6 |</span>
<span class="go">Particle:      7 |        49.0 |   5.765e+06 |      7 |      3 |        7 |</span>
<span class="go">Particle:      8 |        64.0 |   1.678e+07 |      8 |      2 |        8 |</span>
<span class="go">Particle:      9 |        81.0 |   4.305e+07 |      9 |      1 |        9 |</span>
<span class="go">Particle:     10 |       100.0 |       1e+08 |     10 |      0 |       10 |</span>
<span class="go">Particle:     11 |       121.0 |   2.144e+08 |     11 |     -1 |       11 |</span>
<span class="go">Particle:     12 |       144.0 |     4.3e+08 |     12 |     -2 |       12 |</span>
<span class="go">Particle:     13 |       169.0 |   8.157e+08 |     13 |     -3 |       13 |</span>
<span class="go">Particle:     14 |       196.0 |   1.476e+09 |     14 |     -4 |       14 |</span>
</pre></div>
</div>
</section>
<section id="modifying-data-in-tables">
<h3>Modifying data in tables<a class="headerlink" href="#modifying-data-in-tables" title="Link to this heading">¶</a></h3>
<p>Ok, until now, we’ve been only reading and writing (appending) values to our
tables. But there are times that you need to modify your data once you have
saved it on disk (this is specially true when you need to modify the real
world data to adapt your goals ;).
Let’s see how we can modify the values that were saved in our existing tables.
We will start modifying single cells in the first row of the Particle table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before modif--&gt;&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Before modif--&gt; (0, 0, 0.0, 0, 10, 0L, &#39;Particle:      0&#39;, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">TDCcount</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After modifying first row of ADCcount--&gt;&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">After modifying first row of ADCcount--&gt; (0, 1, 0.0, 0, 10, 0L, &#39;Particle:      0&#39;, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After modifying first row of energy--&gt;&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">After modifying first row of energy--&gt; (0, 1, 2.0, 0, 10, 0L, &#39;Particle:      0&#39;, 0.0)</span>
</pre></div>
</div>
<p>We can modify complete ranges of columns as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">TDCcount</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After modifying slice [2:5] of TDCcount--&gt;&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">After modifying slice [2:5] of TDCcount--&gt;</span>
<span class="go">[(0, 1, 2.0, 0, 10, 0L, &#39;Particle:      0&#39;, 0.0)</span>
<span class="go"> (256, 1, 1.0, 1, 9, 17179869184L, &#39;Particle:      1&#39;, 1.0)</span>
<span class="go"> (512, 2, 256.0, 2, 8, 34359738368L, &#39;Particle:      2&#39;, 4.0)</span>
<span class="go"> (768, 3, 6561.0, 3, 7, 51539607552L, &#39;Particle:      3&#39;, 9.0)</span>
<span class="go"> (1024, 4, 65536.0, 4, 6, 68719476736L, &#39;Particle:      4&#39;, 16.0)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">energy</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">9</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After modifying slice [1:9:3] of energy--&gt;&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">])</span>
<span class="go">After modifying slice [1:9:3] of energy--&gt;</span>
<span class="go">[(0, 1, 2.0, 0, 10, 0L, &#39;Particle:      0&#39;, 0.0)</span>
<span class="go"> (256, 1, 2.0, 1, 9, 17179869184L, &#39;Particle:      1&#39;, 1.0)</span>
<span class="go"> (512, 2, 256.0, 2, 8, 34359738368L, &#39;Particle:      2&#39;, 4.0)</span>
<span class="go"> (768, 3, 6561.0, 3, 7, 51539607552L, &#39;Particle:      3&#39;, 9.0)</span>
<span class="go"> (1024, 4, 3.0, 4, 6, 68719476736L, &#39;Particle:      4&#39;, 16.0)</span>
<span class="go"> (1280, 5, 390625.0, 5, 5, 85899345920L, &#39;Particle:      5&#39;, 25.0)</span>
<span class="go"> (1536, 6, 1679616.0, 6, 4, 103079215104L, &#39;Particle:      6&#39;, 36.0)</span>
<span class="go"> (1792, 7, 4.0, 7, 3, 120259084288L, &#39;Particle:      7&#39;, 49.0)</span>
<span class="go"> (2048, 8, 16777216.0, 8, 2, 137438953472L, &#39;Particle:      8&#39;, 64.0)]</span>
</pre></div>
</div>
<p>Check that the values have been correctly modified!</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>remember that column TDCcount is the second one, and that energy is the
third. Look for more info on modifying columns in
<a class="reference internal" href="libref/structured_storage.html#tables.Column.__setitem__" title="tables.Column.__setitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Column.__setitem__()</span></code></a>.</p>
</div>
<p>PyTables also lets you modify complete sets of rows at the same time. As a
demonstration of these capability, see the next example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">modify_rows</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">rows</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="n">L</span><span class="p">,</span> <span class="s1">&#39;Particle:   None&#39;</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="n">L</span><span class="p">,</span> <span class="s1">&#39;Particle: None*2&#39;</span><span class="p">,</span> <span class="mf">16.0</span><span class="p">)])</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After modifying the complete third row--&gt;&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">After modifying the complete third row--&gt;</span>
<span class="go">[(0, 1, 2.0, 0, 10, 0L, &#39;Particle:      0&#39;, 0.0)</span>
<span class="go"> (1, 2, 3.0, 4, 5, 6L, &#39;Particle:   None&#39;, 8.0)</span>
<span class="go"> (512, 2, 256.0, 2, 8, 34359738368L, &#39;Particle:      2&#39;, 4.0)</span>
<span class="go"> (768, 3, 6561.0, 3, 7, 51539607552L, &#39;Particle:      3&#39;, 9.0)</span>
<span class="go"> (2, 4, 6.0, 8, 10, 12L, &#39;Particle: None*2&#39;, 16.0)]</span>
</pre></div>
</div>
<p>As you can see, the modify_rows() call has modified the rows second and fifth,
and it returned the number of modified rows.</p>
<p>Apart of <a class="reference internal" href="libref/structured_storage.html#tables.Table.modify_rows" title="tables.Table.modify_rows"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.modify_rows()</span></code></a>, there exists another method, called
<a class="reference internal" href="libref/structured_storage.html#tables.Table.modify_column" title="tables.Table.modify_column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.modify_column()</span></code></a> to modify specific columns as well.</p>
<p>Finally, there is another way of modifying tables that is generally more
handy than the one described above. This new way uses the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Row.update()</span></code> method of
the Row instance that is attached to every table, so it
is meant to be used in table iterators. Take a look at the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;TDCcount &lt;= 2&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;TDCcount&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span>
<span class="gp">... </span>    <span class="n">row</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After modifying energy column (where TDCcount &lt;=2)--&gt;&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
<span class="go">After modifying energy column (where TDCcount &lt;=2)--&gt;</span>
<span class="go">[(0, 1, 2.0, 0, 10, 0L, &#39;Particle:      0&#39;, 0.0)</span>
<span class="go"> (1, 2, 4.0, 4, 5, 6L, &#39;Particle:   None&#39;, 8.0)</span>
<span class="go"> (512, 2, 4.0, 2, 8, 34359738368L, &#39;Particle:      2&#39;, 4.0)</span>
<span class="go"> (768, 3, 6561.0, 3, 7, 51539607552L, &#39;Particle:      3&#39;, 9.0)]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The authors find this way of updating tables (i.e. using Row.update())
to be both convenient and efficient. Please make sure to use it
extensively.</p>
</div>
<p><em>Caveat emptor</em>: Currently, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Row.update()</span></code> will not work (the table will
not be updated) if the loop is broken with <code class="docutils literal notranslate"><span class="pre">break</span></code> statement. A possible
workaround consists in manually flushing the row internal buffer by calling
<code class="docutils literal notranslate"><span class="pre">row._flushModRows()</span></code> just before the <code class="docutils literal notranslate"><span class="pre">break</span></code> statement.</p>
</section>
<section id="modifying-data-in-arrays">
<h3>Modifying data in arrays<a class="headerlink" href="#modifying-data-in-arrays" title="Link to this heading">¶</a></h3>
<p>We are now going to see how to modify data in array objects.
The basic way to do this is through the use of <a class="reference internal" href="libref/homogenous_storage.html#tables.Array.__setitem__" title="tables.Array.__setitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Array.__setitem__()</span></code></a>
special method. Let’s see how to modify data on the pressureObject array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pressureObject</span> <span class="o">=</span> <span class="n">h5file</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">pressure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before modif--&gt;&quot;</span><span class="p">,</span> <span class="n">pressureObject</span><span class="p">[:])</span>
<span class="go">Before modif--&gt; [ 25.  36.  49.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pressureObject</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First modif--&gt;&quot;</span><span class="p">,</span> <span class="n">pressureObject</span><span class="p">[:])</span>
<span class="go">First modif--&gt; [  2.  36.  49.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pressureObject</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Second modif--&gt;&quot;</span><span class="p">,</span> <span class="n">pressureObject</span><span class="p">[:])</span>
<span class="go">Second modif--&gt; [ 2.   2.1  3.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pressureObject</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Third modif--&gt;&quot;</span><span class="p">,</span> <span class="n">pressureObject</span><span class="p">[:])</span>
<span class="go">Third modif--&gt; [ 1.   2.1  2. ]</span>
</pre></div>
</div>
<p>So, in general, you can use any combination of (multidimensional) extended
slicing.</p>
<p>With the sole exception that you cannot use negative values for step to refer
to indexes that you want to modify. See <a class="reference internal" href="libref/homogenous_storage.html#tables.Array.__getitem__" title="tables.Array.__getitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Array.__getitem__()</span></code></a> for more
examples on how to use extended slicing in PyTables objects.</p>
<p>Similarly, with an array of strings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nameObject</span> <span class="o">=</span> <span class="n">h5file</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before modif--&gt;&quot;</span><span class="p">,</span> <span class="n">nameObject</span><span class="p">[:])</span>
<span class="go">Before modif--&gt; [&#39;Particle:      5&#39;, &#39;Particle:      6&#39;, &#39;Particle:      7&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nameObject</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Particle:   None&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First modif--&gt;&quot;</span><span class="p">,</span> <span class="n">nameObject</span><span class="p">[:])</span>
<span class="go">First modif--&gt; [&#39;Particle:   None&#39;, &#39;Particle:      6&#39;, &#39;Particle:      7&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nameObject</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Particle:      0&#39;</span><span class="p">,</span> <span class="s1">&#39;Particle:      1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Second modif--&gt;&quot;</span><span class="p">,</span> <span class="n">nameObject</span><span class="p">[:])</span>
<span class="go">Second modif--&gt; [&#39;Particle:   None&#39;, &#39;Particle:      0&#39;, &#39;Particle:      1&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nameObject</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Particle:     -3&#39;</span><span class="p">,</span> <span class="s1">&#39;Particle:     -5&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Third modif--&gt;&quot;</span><span class="p">,</span> <span class="n">nameObject</span><span class="p">[:])</span>
<span class="go">Third modif--&gt; [&#39;Particle:     -3&#39;, &#39;Particle:      0&#39;, &#39;Particle:     -5&#39;]</span>
</pre></div>
</div>
</section>
<section id="and-finally-how-to-delete-rows-from-a-table">
<h3>And finally… how to delete rows from a table<a class="headerlink" href="#and-finally-how-to-delete-rows-from-a-table" title="Link to this heading">¶</a></h3>
<p>We’ll finish this tutorial by deleting some rows from the table we have.
Suppose that we want to delete the 5th to 9th rows (inclusive):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">remove_rows</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p><a class="reference internal" href="libref/structured_storage.html#tables.Table.remove_rows" title="tables.Table.remove_rows"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.remove_rows()</span></code></a> deletes the rows in the range (start, stop). It
returns the number of rows effectively removed.</p>
<p>We have reached the end of this first tutorial. Don’t forget to close the
file when you finish:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h5file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">^</span><span class="n">D</span>
<span class="go">$</span>
</pre></div>
</div>
<p>In <a class="reference internal" href="#tutorial1-2-tableview"><span class="std std-ref">Figure 2</span></a> you can see a graphical view of the
PyTables file with the datasets we have just created. In
<a class="reference internal" href="#tutorial1-general"><span class="std std-ref">Figure 3. General properties of the /detector/readout table.</span></a> are displayed the general properties of the table
/detector/readout.</p>
<figure class="align-center" id="id10">
<span id="tutorial1-2-tableview"></span><img alt="../_images/tutorial1-2-tableview.png" src="../_images/tutorial1-2-tableview.png" />
<figcaption>
<p><span class="caption-text"><strong>Figure 2. The final version of the data file for tutorial 1.</strong></span><a class="headerlink" href="#id10" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id11">
<span id="tutorial1-general"></span><img alt="../_images/tutorial1-general.png" src="../_images/tutorial1-general.png" />
<figcaption>
<p><span class="caption-text"><strong>Figure 3. General properties of the /detector/readout table.</strong></span><a class="headerlink" href="#id11" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="multidimensional-table-cells-and-automatic-sanity-checks">
<span id="secondexample"></span><h2>Multidimensional table cells and automatic sanity checks<a class="headerlink" href="#multidimensional-table-cells-and-automatic-sanity-checks" title="Link to this heading">¶</a></h2>
<p>Now it’s time for a more real-life example (i.e. with errors in the code). We
will create two groups that branch directly from the root node, Particles and
Events. Then, we will put three tables in each group. In Particles we will
put tables based on the Particle descriptor and in Events, the tables based
the Event descriptor.</p>
<p>Afterwards, we will provision the tables with a number of records. Finally,
we will read the newly-created table /Events/TEvent3 and select some values
from it, using a comprehension list.</p>
<p>Look at the next script (you can find it in <code class="file docutils literal notranslate"><span class="pre">examples/tutorial2.py</span></code>).
It appears to do all of the above, but it contains some small bugs. Note that
this Particle class is not directly related to the one defined in
last tutorial; this class is simpler (note, however, the <em>multidimensional</em>
columns called pressure and temperature).</p>
<p>We also introduce a new manner to describe a Table as a structured NumPy
dtype (or even as a dictionary), as you can see in the Event description. See
<a class="reference internal" href="libref/file_class.html#tables.File.create_table" title="tables.File.create_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.create_table()</span></code></a> for different kinds of descriptor objects that
can be passed to this method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tables</span> <span class="k">as</span> <span class="nn">tb</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Describe a particle record</span>
<span class="k">class</span> <span class="nc">Particle</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">IsDescription</span><span class="p">):</span>
    <span class="n">name</span>        <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">StringCol</span><span class="p">(</span><span class="n">itemsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>  <span class="c1"># 16-character string</span>
    <span class="n">lati</span>        <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">Int32Col</span><span class="p">()</span>              <span class="c1"># integer</span>
    <span class="n">longi</span>       <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">Int32Col</span><span class="p">()</span>              <span class="c1"># integer</span>
    <span class="n">pressure</span>    <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">Float32Col</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="c1"># array of floats (single-precision)</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">Float64Col</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="c1"># array of doubles (double-precision)</span>

<span class="c1"># Native NumPy dtype instances are also accepted</span>
<span class="n">Event</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;name&quot;</span>     <span class="p">,</span> <span class="s2">&quot;S16&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;TDCcount&quot;</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;ADCcount&quot;</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;xcoord&quot;</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;ycoord&quot;</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="p">])</span>

<span class="c1"># And dictionaries too (this defines the same structure as above)</span>
<span class="c1"># Event = {</span>
<span class="c1">#     &quot;name&quot;     : tb.StringCol(itemsize=16),</span>
<span class="c1">#     &quot;TDCcount&quot; : tb.UInt8Col(),</span>
<span class="c1">#     &quot;ADCcount&quot; : tb.UInt16Col(),</span>
<span class="c1">#     &quot;xcoord&quot;   : tb.Float32Col(),</span>
<span class="c1">#     &quot;ycoord&quot;   : tb.Float32Col(),</span>
<span class="c1">#     }</span>

<span class="c1"># Open a file in &quot;w&quot;rite mode</span>
<span class="n">fileh</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="s2">&quot;tutorial2.h5&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="c1"># Get the HDF5 root group</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">fileh</span><span class="o">.</span><span class="n">root</span>

<span class="c1"># Create the groups:</span>
<span class="k">for</span> <span class="n">groupname</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Particles&quot;</span><span class="p">,</span> <span class="s2">&quot;Events&quot;</span><span class="p">):</span>
    <span class="n">group</span> <span class="o">=</span> <span class="n">fileh</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">groupname</span><span class="p">)</span>

<span class="c1"># Now, create and fill the tables in Particles group</span>
<span class="n">gparticles</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">Particles</span>

<span class="c1"># Create 3 new tables</span>
<span class="k">for</span> <span class="n">tablename</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;TParticle1&quot;</span><span class="p">,</span> <span class="s2">&quot;TParticle2&quot;</span><span class="p">,</span> <span class="s2">&quot;TParticle3&quot;</span><span class="p">):</span>
    <span class="c1"># Create a table</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">fileh</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="s2">&quot;/Particles&quot;</span><span class="p">,</span> <span class="n">tablename</span><span class="p">,</span> <span class="n">Particle</span><span class="p">,</span> <span class="s2">&quot;Particles: &quot;</span><span class="o">+</span><span class="n">tablename</span><span class="p">)</span>

    <span class="c1"># Get the record object associated with the table:</span>
    <span class="n">particle</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">row</span>

    <span class="c1"># Fill the table with 257 particles</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">257</span><span class="p">):</span>
        <span class="c1"># First, assign the values to the Particle record</span>
        <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Particle: </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s1">6d</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;lati&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;longi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">-</span> <span class="n">i</span>

        <span class="c1">########### Detectable errors start here. Play with them!</span>
        <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># Incorrect</span>
        <span class="c1">#particle[&#39;pressure&#39;] = i * np.arange(2 * 3).reshape(2, 3) # Correct</span>
        <span class="c1">########### End of errors</span>

        <span class="n">particle</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">**</span> <span class="mi">2</span>     <span class="c1"># Broadcasting</span>

        <span class="c1"># This injects the Record values</span>
        <span class="n">particle</span><span class="o">.</span><span class="n">append</span><span class="p">()</span>

    <span class="c1"># Flush the table buffers</span>
    <span class="n">table</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="c1"># Now, go for Events:</span>
<span class="k">for</span> <span class="n">tablename</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;TEvent1&quot;</span><span class="p">,</span> <span class="s2">&quot;TEvent2&quot;</span><span class="p">,</span> <span class="s2">&quot;TEvent3&quot;</span><span class="p">):</span>
    <span class="c1"># Create a table in Events group</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">fileh</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">Events</span><span class="p">,</span> <span class="n">tablename</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="s2">&quot;Events: &quot;</span><span class="o">+</span><span class="n">tablename</span><span class="p">)</span>

    <span class="c1"># Get the record object associated with the table:</span>
    <span class="n">event</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">row</span>

    <span class="c1"># Fill the table with 257 events</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">257</span><span class="p">):</span>
        <span class="c1"># First, assign the values to the Event record</span>
        <span class="n">event</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Event: </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s1">6d</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">event</span><span class="p">[</span><span class="s1">&#39;TDCcount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">)</span>   <span class="c1"># Correct range</span>

        <span class="c1">########### Detectable errors start here. Play with them!</span>
        <span class="n">event</span><span class="p">[</span><span class="s1">&#39;xcoor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>     <span class="c1"># Wrong spelling</span>
        <span class="c1">#event[&#39;xcoord&#39;] = float(i ** 2)   # Correct spelling</span>
        <span class="n">event</span><span class="p">[</span><span class="s1">&#39;ADCcount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sss&quot;</span>        <span class="c1"># Wrong type</span>
        <span class="c1">#event[&#39;ADCcount&#39;] = i * 2       # Correct type</span>
        <span class="c1">########### End of errors</span>

        <span class="n">event</span><span class="p">[</span><span class="s1">&#39;ycoord&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>

        <span class="c1"># This injects the Record values</span>
        <span class="n">event</span><span class="o">.</span><span class="n">append</span><span class="p">()</span>

    <span class="c1"># Flush the buffers</span>
    <span class="n">table</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="c1"># Read the records from table &quot;/Events/TEvent3&quot; and select some</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">Events</span><span class="o">.</span><span class="n">TEvent3</span>
<span class="n">e</span> <span class="o">=</span> <span class="p">[</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;TDCcount&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">table</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ADCcount&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">20</span> <span class="ow">and</span> <span class="mi">4</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;TDCcount&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">15</span> <span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Last record ==&gt; </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected values ==&gt; </span><span class="si">{e}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total selected records ==&gt; {len(e)}&quot;</span><span class="p">)</span>

<span class="c1"># Finally, close the file (this also will flush all the remaining buffers!)</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<section id="shape-checking">
<h3>Shape checking<a class="headerlink" href="#shape-checking" title="Link to this heading">¶</a></h3>
<p>If you look at the code carefully, you’ll see that it won’t work. You will
get the following error.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python3<span class="w"> </span>tutorial2.py
Traceback<span class="w"> </span><span class="o">(</span>most<span class="w"> </span>recent<span class="w"> </span>call<span class="w"> </span>last<span class="o">)</span>:
<span class="w">  </span>File<span class="w"> </span><span class="s2">&quot;tutorial2.py&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">60</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>&lt;module&gt;
<span class="w">    </span>particle<span class="o">[</span><span class="s1">&#39;pressure&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>array<span class="o">(</span>i<span class="w"> </span>*<span class="w"> </span>arange<span class="o">(</span><span class="m">2</span><span class="w"> </span>*<span class="w"> </span><span class="m">3</span><span class="o">))</span>.reshape<span class="o">((</span><span class="m">2</span>,<span class="w"> </span><span class="m">4</span><span class="o">))</span><span class="w">  </span><span class="c1"># Incorrect</span>
ValueError:<span class="w"> </span>total<span class="w"> </span>size<span class="w"> </span>of<span class="w"> </span>new<span class="w"> </span>array<span class="w"> </span>must<span class="w"> </span>be<span class="w"> </span>unchanged
Closing<span class="w"> </span>remaining<span class="w"> </span>open<span class="w"> </span>files:<span class="w"> </span>tutorial2.h5...<span class="w"> </span><span class="k">done</span>
</pre></div>
</div>
<p>This error indicates that you are trying to assign an array with an
incompatible shape to a table cell. Looking at the source, we see that we
were trying to assign an array of shape (2,4) to a pressure element, which
was defined with the shape (2,3).</p>
<p>In general, these kinds of operations are forbidden, with one valid
exception: when you assign a <em>scalar</em> value to a multidimensional column
cell, all the cell elements are populated with the value of the scalar.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particle</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">**</span> <span class="mi">2</span>    <span class="c1"># Broadcasting</span>
</pre></div>
</div>
<p>The value i**2 is assigned to all the elements of the temperature table cell.
This capability is provided by the NumPy package and is known as
<em>broadcasting</em>.</p>
</section>
<section id="field-name-checking">
<h3>Field name checking<a class="headerlink" href="#field-name-checking" title="Link to this heading">¶</a></h3>
<p>After fixing the previous error and rerunning the program, we encounter
another error.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python3<span class="w"> </span>tutorial2.py
Traceback<span class="w"> </span><span class="o">(</span>most<span class="w"> </span>recent<span class="w"> </span>call<span class="w"> </span>last<span class="o">)</span>:
<span class="w">  </span>File<span class="w"> </span><span class="s2">&quot;tutorial2.py&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">73</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>?
<span class="w">    </span>event<span class="o">[</span><span class="s1">&#39;xcoor&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>float<span class="o">(</span>i<span class="w"> </span>**<span class="w"> </span><span class="m">2</span><span class="o">)</span><span class="w">     </span><span class="c1"># Wrong spelling</span>
<span class="w">  </span>File<span class="w"> </span><span class="s2">&quot;tableextension.pyx&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">1094</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>tableextension.Row.__setitem__
<span class="w">  </span>File<span class="w"> </span><span class="s2">&quot;tableextension.pyx&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">127</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>tableextension.get_nested_field_cache
<span class="w">  </span>File<span class="w"> </span><span class="s2">&quot;utilsextension.pyx&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">331</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>utilsextension.get_nested_field
KeyError:<span class="w"> </span><span class="s1">&#39;no such column: xcoor&#39;</span>
</pre></div>
</div>
<p>This error indicates that we are attempting to assign a value to a
non-existent field in the <em>event</em> table object. By looking carefully at the
Event class attributes, we see that we misspelled the xcoord field (we wrote
xcoor instead). This is unusual behavior for Python, as normally when you
assign a value to a non-existent instance variable, Python creates a new
variable with that name. Such a feature can be dangerous when dealing with an
object that contains a fixed list of field names. PyTables checks that the
field exists and raises a KeyError if the check fails.</p>
</section>
<section id="data-type-checking">
<h3>Data type checking<a class="headerlink" href="#data-type-checking" title="Link to this heading">¶</a></h3>
<p>Finally, the last issue which we will find here is a TypeError exception.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python3<span class="w"> </span>tutorial2.py
Traceback<span class="w"> </span><span class="o">(</span>most<span class="w"> </span>recent<span class="w"> </span>call<span class="w"> </span>last<span class="o">)</span>:
<span class="w">  </span>File<span class="w"> </span><span class="s2">&quot;tutorial2.py&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">75</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>?
<span class="w">    </span>event<span class="o">[</span><span class="s1">&#39;ADCcount&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;sss&quot;</span><span class="w">          </span><span class="c1"># Wrong type</span>
<span class="w">  </span>File<span class="w"> </span><span class="s2">&quot;tableextension.pyx&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">1111</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>tableextension.Row.__setitem__
TypeError:<span class="w"> </span>invalid<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="o">(</span>&lt;<span class="nb">type</span><span class="w"> </span><span class="s1">&#39;str&#39;</span>&gt;<span class="o">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>column<span class="w"> </span><span class="sb">``</span>ADCcount<span class="sb">``</span>
</pre></div>
</div>
<p>And, if we change the affected line to read:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">event</span><span class="o">.</span><span class="n">ADCcount</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span>        <span class="c1"># Correct type</span>
</pre></div>
</div>
<p>we will see that the script ends well.</p>
<p>You can see the structure created with this (corrected) script in
<a class="reference internal" href="#tutorial2-tableview"><span class="std std-ref">Figure 4</span></a>.
In particular, note the multidimensional column cells in table
/Particles/TParticle2.</p>
<figure class="align-center" id="id12">
<span id="tutorial2-tableview"></span><img alt="../_images/tutorial2-tableview.png" src="../_images/tutorial2-tableview.png" />
<figcaption>
<p><span class="caption-text"><strong>Figure 4. Table hierarchy for tutorial 2.</strong></span><a class="headerlink" href="#id12" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="using-links-for-more-convenient-access-to-nodes">
<span id="linkstutorial"></span><h2>Using links for more convenient access to nodes<a class="headerlink" href="#using-links-for-more-convenient-access-to-nodes" title="Link to this heading">¶</a></h2>
<p>Links are special nodes that can be used to create additional paths to your
existing nodes.  PyTables supports three kinds of links: hard links, soft
links (aka symbolic links) and external links.</p>
<p>Hard links let the user create additional paths to access another node in the
same file, and once created, they are indistinguishable from the referred
node object, except that they have different paths in the object tree.  For
example, if the referred node is, say, a Table object, then the new hard link
will become a Table object itself.  From this point on, you will be able to
access the same Table object from two different paths: the original one and
the new hard link path.  If you delete one path to the table, you will be
able to reach it via the other path.</p>
<p>Soft links are similar to hard links, but they keep their own personality.
When you create a soft link to another node, you will get a new SoftLink
object that <em>refers</em> to that node.  However, in order to access the referred
node, you need to <em>dereference</em> it.</p>
<p>Finally, external links are like soft links, with the difference that these
are meant to point to nodes in <em>external</em> files instead of nodes in the same
file.  They are represented by the ExternalLink class and, like soft links,
you need to dereference them in order to get access to the pointed node.</p>
<section id="interactive-example">
<h3>Interactive example<a class="headerlink" href="#interactive-example" title="Link to this heading">¶</a></h3>
<p>Now we are going to learn how to deal with links. You can find the code used
in this section in <code class="file docutils literal notranslate"><span class="pre">examples/links.py</span></code>.</p>
<p>First, let’s create a file with some group structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tables</span> <span class="k">as</span> <span class="nn">tb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="s1">&#39;links1.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;g1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g2</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="s1">&#39;g2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we will put some datasets on the /g1 and /g1/g2 groups:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">create_carray</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="n">tb</span><span class="o">.</span><span class="n">Int64Atom</span><span class="p">(),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10000</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">g2</span><span class="p">,</span> <span class="s1">&#39;t1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;f1&#39;</span><span class="p">:</span> <span class="n">tb</span><span class="o">.</span><span class="n">IntCol</span><span class="p">(),</span> <span class="s1">&#39;f2&#39;</span><span class="p">:</span> <span class="n">tb</span><span class="o">.</span><span class="n">FloatCol</span><span class="p">()})</span>
</pre></div>
</div>
<p>We can start the party now.  We are going to create a new group, say /gl,
where we will put our links and will start creating one hard link too:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gl</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;gl&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ht</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">create_hard_link</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span> <span class="s1">&#39;ht&#39;</span><span class="p">,</span> <span class="s1">&#39;/g1/g2/t1&#39;</span><span class="p">)</span>  <span class="c1"># ht points to t1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;``</span><span class="si">{</span><span class="n">ht</span><span class="si">}</span><span class="s2">`` is a hard link to: ``</span><span class="si">{</span><span class="n">t1</span><span class="si">}</span><span class="s2">``&quot;</span><span class="p">)</span>
<span class="go">``/gl/ht (Table(0,)) `` is a hard link to: ``/g1/g2/t1 (Table(0,)) ``</span>
</pre></div>
</div>
<p>You can see how we’ve created a hard link in /gl/ht which is pointing to the
existing table in /g1/g2/t1.  Have look at how the hard link is represented;
it looks like a table, and actually, it is a <em>real</em> table.  We have two
different paths to access that table, the original /g1/g2/t1 and the new one
/gl/ht.  If we remove the original path we still can reach the table by using
the new path:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;table continues to be accessible in: ``</span><span class="si">{</span><span class="n">f1</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s1">&#39;/gl/ht&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">``&quot;</span><span class="p">)</span>
<span class="go">table continues to be accessible in: ``/gl/ht (Table(0,)) ``</span>
</pre></div>
</div>
<p>So far so good. Now, let’s create a couple of soft links:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">la1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">create_soft_link</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span> <span class="s1">&#39;la1&#39;</span><span class="p">,</span> <span class="s1">&#39;/g1/a1&#39;</span><span class="p">)</span>  <span class="c1"># la1 points to a1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;``</span><span class="si">{</span><span class="n">la1</span><span class="si">}</span><span class="s2">`` is a soft link to: ``</span><span class="si">{</span><span class="n">la1</span><span class="o">.</span><span class="n">target</span><span class="si">}</span><span class="s2">``&quot;</span><span class="p">)</span>
<span class="go">``/gl/la1 (SoftLink) -&gt; /g1/a1`` is a soft link to: ``/g1/a1``</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lt</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">create_soft_link</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span> <span class="s1">&#39;lt&#39;</span><span class="p">,</span> <span class="s1">&#39;/g1/g2/t1&#39;</span><span class="p">)</span>  <span class="c1"># lt points to t1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;``</span><span class="si">{</span><span class="n">lt</span><span class="si">}</span><span class="s2">`` is a soft link to: ``</span><span class="si">{</span><span class="n">lt</span><span class="o">.</span><span class="n">target</span><span class="si">}</span><span class="s2">``&quot;</span><span class="p">)</span>
<span class="go">``/gl/lt (SoftLink) -&gt; /g1/g2/t1 (dangling)`` is a soft link to: ``/g1/g2/t1``</span>
</pre></div>
</div>
<p>Okay, we see how the first link /gl/la1 points to the array /g1/a1.  Notice
how the link prints as a SoftLink, and how the referred node is stored in the
target instance attribute.  The second link (/gt/lt) pointing to /g1/g2/t1
also has been created successfully, but by better inspecting the string
representation of it, we see that is labeled as ‘(dangling)’.  Why is this?
Well, you should remember that we recently removed the /g1/g2/t1 path to
access table t1.  When printing it, the object knows that it points to
<em>nowhere</em> and reports this.
This is a nice way to quickly know whether a soft link points to an exiting
node or not.</p>
<p>So, let’s re-create the removed path to t1 table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">create_hard_link</span><span class="p">(</span><span class="s1">&#39;/g1/g2&#39;</span><span class="p">,</span> <span class="s1">&#39;t1&#39;</span><span class="p">,</span> <span class="s1">&#39;/gl/ht&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;``</span><span class="si">{</span><span class="n">lt</span><span class="si">}</span><span class="s2">`` is not dangling anymore&quot;</span><span class="p">)</span>
<span class="go">``/gl/lt (SoftLink) -&gt; /g1/g2/t1`` is not dangling anymore</span>
</pre></div>
</div>
<p>and the soft link is pointing to an existing node now.</p>
<p>Of course, for soft links to serve any actual purpose we need a way to get
the pointed node.  It happens that soft links are callable, and that’s the
way to get the referred nodes back:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span> <span class="o">=</span> <span class="n">lt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dereferred lt node: ``</span><span class="si">{</span><span class="n">plt</span><span class="si">}</span><span class="s2">``&quot;</span><span class="p">)</span>
<span class="go">dereferred lt node: ``/g1/g2/t1 (Table(0,)) ``</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pla1</span> <span class="o">=</span> <span class="n">la1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dereferred la1 node: ``</span><span class="si">{</span><span class="n">pla1</span><span class="si">}</span><span class="s2">``&quot;</span><span class="p">)</span>
<span class="go">dereferred la1 node: ``/g1/a1 (CArray(10000,)) ``</span>
</pre></div>
</div>
<p>Now, plt is a Python reference to the t1 table while pla1 refers to the a1
array.  Easy, uh?</p>
<p>Let’s suppose now that a1 is an array whose access speed is critical for our
application.  One possible solution is to move the entire file into a faster
disk, say, a solid state disk so that access latencies can be reduced quite a
lot.  However, it happens that our file is too big to fit into our shiny new
(although small in capacity) SSD disk.  A solution is to copy just the a1
array into a separate file that would fit into our SSD disk.  However, our
application would be able to handle two files instead of only one, adding
significantly more complexity, which is not a good thing.</p>
<p>External links to the rescue!  As we’ve already said, external links are like
soft links, but they are designed to link objects in external files.  Back to
our problem, let’s copy the a1 array into a different file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="s1">&#39;links2.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_a1</span> <span class="o">=</span> <span class="n">a1</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">f2</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s1">&#39;a1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># close the other file</span>
</pre></div>
</div>
<p>And now, we can remove the existing soft link and create the external link in
its place:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">la1</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">la1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">create_external_link</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span> <span class="s1">&#39;la1&#39;</span><span class="p">,</span> <span class="s1">&#39;links2.h5:/a1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;``</span><span class="si">{</span><span class="n">la1</span><span class="si">}</span><span class="s2">`` is an external link to: ``</span><span class="si">{</span><span class="n">la1</span><span class="o">.</span><span class="n">target</span><span class="si">}</span><span class="s2">``&quot;</span><span class="p">)</span>
<span class="go">``/gl/la1 (ExternalLink) -&gt; links2.h5:/a1`` is an external link to: ``links2.h5:/a1``</span>
</pre></div>
</div>
<p>Let’s try dereferring it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_a1</span> <span class="o">=</span> <span class="n">la1</span><span class="p">()</span>  <span class="c1"># dereferrencing la1 returns a1 in links2.h5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dereferred la1 node:  ``</span><span class="si">{</span><span class="n">new_a1</span><span class="si">}</span><span class="s2">``&quot;</span><span class="p">)</span>
<span class="go">dereferred la1 node:  ``/a1 (CArray(10000,)) ``</span>
</pre></div>
</div>
<p>Well, it seems like we can access the external node.  But just to make sure
that the node is in the other file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;new_a1 file:&quot;</span><span class="p">,</span> <span class="n">new_a1</span><span class="o">.</span><span class="n">_v_file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
<span class="go">new_a1 file: links2.h5</span>
</pre></div>
</div>
<p>Okay, the node is definitely in the external file.  So, you won’t have to
worry about your application: it will work exactly the same no matter the
link is internal (soft) or external.</p>
<p>Finally, here it is a dump of the objects in the final file, just to get a
better idea of what we ended with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exit</span><span class="p">()</span>
<span class="go">$ ptdump links1.h5</span>
<span class="go">/ (RootGroup) &#39;&#39;</span>
<span class="go">/g1 (Group) &#39;&#39;</span>
<span class="go">/g1/a1 (CArray(10000,)) &#39;&#39;</span>
<span class="go">/gl (Group) &#39;&#39;</span>
<span class="go">/gl/ht (Table(0,)) &#39;&#39;</span>
<span class="go">/gl/la1 (ExternalLink) -&gt; links2.h5:/a1</span>
<span class="go">/gl/lt (SoftLink) -&gt; /g1/g2/t1</span>
<span class="go">/g1/g2 (Group) &#39;&#39;</span>
<span class="go">/g1/g2/t1 (Table(0,)) &#39;&#39;</span>
</pre></div>
</div>
<p>This ends this tutorial.  I hope it helped you to appreciate how useful links
can be.  I’m sure you will find other ways in which you can use links that
better fit your own needs.</p>
</section>
</section>
<section id="exercising-the-undo-redo-feature">
<h2>Exercising the Undo/Redo feature<a class="headerlink" href="#exercising-the-undo-redo-feature" title="Link to this heading">¶</a></h2>
<p>PyTables has integrated support for undoing and/or redoing actions. This
functionality lets you put marks in specific places of your hierarchy
manipulation operations, so that you can make your HDF5 file pop back
(<em>undo</em>) to a specific mark (for example for inspecting how your hierarchy
looked at that point). You can also go forward to a more recent marker
(<em>redo</em>). You can even do jumps to the marker you want using just one
instruction as we will see shortly.</p>
<p>You can undo/redo all the operations that are related to object tree
management, like creating, deleting, moving or renaming nodes (or complete
sub-hierarchies) inside a given object tree. You can also undo/redo
operations (i.e. creation, deletion or modification) of persistent node
attributes. However, actions which include <em>internal</em> modifications of datasets
(that includes Table.append, Table.modify_rows or Table.remove_rows, among others)
cannot be currently undone/redone.</p>
<p>This capability can be useful in many situations, for example when doing
simulations with multiple branches. When you have to choose a path to follow
in such a situation, you can put a mark there and, if the simulation is not
going well, you can go back to that mark and start another path. Another
possible application is defining coarse-grained operations which operate in a
transactional-like way, i.e. which return the database to its previous state
if the operation finds some kind of problem while running. You can probably
devise many other scenarios where the Undo/Redo feature can be useful to you
<a class="footnote-reference brackets" href="#id7" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<section id="a-basic-example">
<h3>A basic example<a class="headerlink" href="#a-basic-example" title="Link to this heading">¶</a></h3>
<p>In this section, we are going to show the basic behavior of the Undo/Redo
feature. You can find the code used in this example in
<code class="file docutils literal notranslate"><span class="pre">examples/tutorial3-1.py</span></code>. A somewhat more complex example will be
explained in the next section.</p>
<p>First, let’s create a file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="s2">&quot;tutorial3-1.h5&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Undo/Redo demo 1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>And now, activate the Undo/Redo feature with the method
<a class="reference internal" href="libref/file_class.html#tables.File.enable_undo" title="tables.File.enable_undo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.enable_undo()</span></code></a> of File:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">enable_undo</span><span class="p">()</span>
</pre></div>
</div>
<p>From now on, all our actions will be logged internally by PyTables. Now, we
are going to create a node (in this case an Array object):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">one</span> <span class="o">=</span> <span class="n">fileh</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;anarray&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;An array&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, mark this point:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">mark</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>We have marked the current point in the sequence of actions.
In addition, the mark() method has returned the identifier assigned to this
new mark, that is 1 (mark #0 is reserved for the implicit mark at the
beginning of the action log). In the next section we will see that you can
also assign a <em>name</em> to a mark (see <a class="reference internal" href="libref/file_class.html#tables.File.mark" title="tables.File.mark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.mark()</span></code></a> for more info on
mark()).
Now, we are going to create another array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">another</span> <span class="o">=</span> <span class="n">fileh</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;anotherarray&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;Another array&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Right. Now, we can start doing funny things. Let’s say that we want to pop
back to the previous mark (that whose value was 1, do you remember?). Let’s
introduce the undo() method (see <a class="reference internal" href="libref/file_class.html#tables.File.undo" title="tables.File.undo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.undo()</span></code></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">undo</span><span class="p">()</span>
</pre></div>
</div>
<p>Fine, what do you think happened? Well, let’s have a look at the object
tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fileh</span><span class="p">)</span>
<span class="go">tutorial3-1.h5 (File) &#39;Undo/Redo demo 1&#39;</span>
<span class="go">Last modif.: &#39;Tue Mar 13 11:43:55 2007&#39;</span>
<span class="go">Object Tree:</span>
<span class="go">/ (RootGroup) &#39;Undo/Redo demo 1&#39;</span>
<span class="go">/anarray (Array(2,)) &#39;An array&#39;</span>
</pre></div>
</div>
<p>What happened with the /anotherarray node we’ve just created? You’ve guessed it,
it has disappeared because it was created <em>after</em> the mark 1. If you are
curious enough you may ask - where has it gone? Well, it has not been
deleted completely; it has just been moved into a special, hidden group of
PyTables that renders it invisible and waiting for a chance to be reborn.</p>
<p>Now, unwind once more, and look at the object tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">undo</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fileh</span><span class="p">)</span>
<span class="go">tutorial3-1.h5 (File) &#39;Undo/Redo demo 1&#39;</span>
<span class="go">Last modif.: &#39;Tue Mar 13 11:43:55 2007&#39;</span>
<span class="go">Object Tree:</span>
<span class="go">/ (RootGroup) &#39;Undo/Redo demo 1&#39;</span>
</pre></div>
</div>
<p>Oops, /anarray has disappeared as well!
Don’t worry, it will visit us again very shortly. So, you might be somewhat lost
right now; at which mark are we? Let’s ask the <a class="reference internal" href="libref/file_class.html#tables.File.get_current_mark" title="tables.File.get_current_mark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.get_current_mark()</span></code></a>
method in the file handler:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fileh</span><span class="o">.</span><span class="n">get_current_mark</span><span class="p">())</span>
<span class="go">0</span>
</pre></div>
</div>
<p>So we are at mark #0, remember? Mark #0 is an implicit mark that is created
when you start the log of actions when calling File.enable_undo(). Fine, but
you are missing your too-young-to-die arrays. What can we do about that?
<a class="reference internal" href="libref/file_class.html#tables.File.redo" title="tables.File.redo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.redo()</span></code></a> to the rescue:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">redo</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fileh</span><span class="p">)</span>
<span class="go">tutorial3-1.h5 (File) &#39;Undo/Redo demo 1&#39;</span>
<span class="go">Last modif.: &#39;Tue Mar 13 11:43:55 2007&#39;</span>
<span class="go">Object Tree:</span>
<span class="go">/ (RootGroup) &#39;Undo/Redo demo 1&#39;</span>
<span class="go">/anarray (Array(2,)) &#39;An array&#39;</span>
</pre></div>
</div>
<p>Great! The /anarray array has come into life again. Just check that it is
alive and well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">anarray</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">[3, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">anarray</span><span class="o">.</span><span class="n">title</span>
<span class="go">&#39;An array&#39;</span>
</pre></div>
</div>
<p>Well, it looks pretty similar to its past life;
what’s more, it is exactly the same object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">anarray</span> <span class="ow">is</span> <span class="n">one</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It was just moved to the hidden group and back again, that’s all!
That’s kind of fun, so we are going to do the same with /anotherarray:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">redo</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fileh</span><span class="p">)</span>
<span class="go">tutorial3-1.h5 (File) &#39;Undo/Redo demo 1&#39;</span>
<span class="go">Last modif.: &#39;Tue Mar 13 11:43:55 2007&#39;</span>
<span class="go">Object Tree:</span>
<span class="go">/ (RootGroup) &#39;Undo/Redo demo 1&#39;</span>
<span class="go">/anarray (Array(2,)) &#39;An array&#39;</span>
<span class="go">/anotherarray (Array(2,)) &#39;Another array&#39;</span>
</pre></div>
</div>
<p>Welcome back, /anotherarray! Just a couple of sanity checks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">anotherarray</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">anotherarray</span><span class="o">.</span><span class="n">title</span> <span class="o">==</span> <span class="s2">&quot;Another array&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">anotherarray</span> <span class="ow">is</span> <span class="n">another</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Nice, you managed to turn your data back to life.
Congratulations! But wait, do not forget to close your action log when you
don’t need this feature anymore:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">disable_undo</span><span class="p">()</span>
</pre></div>
</div>
<p>That will allow you to continue working with your data without actually
requiring PyTables to keep track of all your actions, and more importantly,
allowing your objects to die completely if they have to, not requiring to
keep them anywhere, hence saving process time and space in your database
file.</p>
</section>
<section id="a-more-complete-example">
<h3>A more complete example<a class="headerlink" href="#a-more-complete-example" title="Link to this heading">¶</a></h3>
<p>Now, time for a somewhat more sophisticated demonstration of the Undo/Redo
feature. In it, several marks will be set in different parts of the code flow
and we will see how to jump between these marks with just one method call.
You can find the code used in this example in <code class="file docutils literal notranslate"><span class="pre">examples/tutorial3-2.py</span></code></p>
<p>Let’s introduce the first part of the code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tables</span>

<span class="c1"># Create an HDF5 file</span>
<span class="n">fileh</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="s1">&#39;tutorial3-2.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Undo/Redo demo 2&#39;</span><span class="p">)</span>

        <span class="c1">#&#39;-**-**-**-**-**-**- enable undo/redo log  -**-**-**-**-**-**-**-&#39;</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">enable_undo</span><span class="p">()</span>

<span class="c1"># Start undoable operations</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;otherarray1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;Another array 1&#39;</span><span class="p">)</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;agroup&#39;</span><span class="p">,</span> <span class="s1">&#39;Group 1&#39;</span><span class="p">)</span>

<span class="c1"># Create a &#39;first&#39; mark</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">mark</span><span class="p">(</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;/agroup&#39;</span><span class="p">,</span> <span class="s1">&#39;otherarray2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;Another array 2&#39;</span><span class="p">)</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;/agroup&#39;</span><span class="p">,</span> <span class="s1">&#39;agroup2&#39;</span><span class="p">,</span> <span class="s1">&#39;Group 2&#39;</span><span class="p">)</span>

<span class="c1"># Create a &#39;second&#39; mark</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">mark</span><span class="p">(</span><span class="s1">&#39;second&#39;</span><span class="p">)</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;/agroup/agroup2&#39;</span><span class="p">,</span> <span class="s1">&#39;otherarray3&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;Another array 3&#39;</span><span class="p">)</span>

<span class="c1"># Create a &#39;third&#39; mark</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">mark</span><span class="p">(</span><span class="s1">&#39;third&#39;</span><span class="p">)</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;otherarray4&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="s1">&#39;Another array 4&#39;</span><span class="p">)</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;/agroup&#39;</span><span class="p">,</span> <span class="s1">&#39;otherarray5&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="s1">&#39;Another array 5&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can see how we have set several marks interspersed in the code flow,
representing different states of the database. Also, note that we have
assigned <em>names</em> to these marks, namely ‘first’, ‘second’ and ‘third’.</p>
<p>Now, start doing some jumps back and forth in the states of the database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now go to mark &#39;first&#39;</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s1">&#39;/otherarray1&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/agroup2&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/otherarray2&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/agroup2/otherarray3&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/otherarray4&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/otherarray5&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fileh</span>

<span class="c1"># Go to mark &#39;third&#39;</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s1">&#39;third&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s1">&#39;/otherarray1&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/agroup2&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/otherarray2&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/agroup2/otherarray3&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/otherarray4&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/otherarray5&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fileh</span>

<span class="c1"># Now go to mark &#39;second&#39;</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s1">&#39;second&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s1">&#39;/otherarray1&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/agroup2&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/otherarray2&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/agroup2/otherarray3&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/otherarray4&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/otherarray5&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fileh</span>
</pre></div>
</div>
<p>Well, the code above shows how easy is to jump to a certain mark in the
database by using the <a class="reference internal" href="libref/file_class.html#tables.File.goto" title="tables.File.goto"><code class="xref py py-meth docutils literal notranslate"><span class="pre">File.goto()</span></code></a> method.</p>
<p>There are also a couple of implicit marks for going to the beginning or the
end of the saved states: 0 and -1. Going to mark #0 means go to the beginning
of the saved actions, that is, when method fileh.enable_undo() was called.
Going to mark #-1 means go to the last recorded action, that is the last
action in the code flow.</p>
<p>Let’s see what happens when going to the end of the action log:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Go to the end</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">assert</span> <span class="s1">&#39;/otherarray1&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/agroup2&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/otherarray2&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/agroup2/otherarray3&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/otherarray4&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>
<span class="k">assert</span> <span class="s1">&#39;/agroup/otherarray5&#39;</span> <span class="ow">in</span> <span class="n">fileh</span>

<span class="c1"># Check that objects have come back to life in a sane state</span>
<span class="k">assert</span> <span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">otherarray1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">agroup</span><span class="o">.</span><span class="n">otherarray2</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">agroup</span><span class="o">.</span><span class="n">agroup2</span><span class="o">.</span><span class="n">otherarray3</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">otherarray4</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">agroup</span><span class="o">.</span><span class="n">otherarray5</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<p>Try going to the beginning of the action log yourself (remember, mark #0)
and check contents of the object tree.</p>
<p>We have nearly finished this demonstration. As always, do not forget to close
the action log as well as the database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#&#39;-**-**-**-**-**-**- disable undo/redo log  -**-**-**-**-**-**-**-&#39;</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">disable_undo</span><span class="p">()</span>
<span class="c1"># Close the file</span>
<span class="n">fileh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>You might want to check other examples on Undo/Redo feature that appear in
<code class="file docutils literal notranslate"><span class="pre">examples/undo-redo.py</span></code>.</p>
</section>
</section>
<section id="using-enumerated-types">
<h2>Using enumerated types<a class="headerlink" href="#using-enumerated-types" title="Link to this heading">¶</a></h2>
<p>PyTables includes support for handling enumerated types. Those types are
defined by providing an exhaustive <em>set</em> or <em>list</em> of possible, named values
for a variable of that type. Enumerated variables of the same type are
usually compared between them for equality and sometimes for order, but are
not usually operated upon.</p>
<p>Enumerated values have an associated <em>name</em> and <em>concrete value</em>. Every name
is unique and so are concrete values. An enumerated variable always takes the
concrete value, not its name. Usually, the concrete value is not used
directly, and frequently it is entirely irrelevant. For the same reason, an
enumerated variable is not usually compared with concrete values out of its
enumerated type. For that kind of use, standard variables and constants are
more adequate.</p>
<p>PyTables provides the Enum (see <a class="reference internal" href="libref/helper_classes.html#enumclassdescr"><span class="std std-ref">The Enum class</span></a>) class to provide
support for enumerated types. Each instance of Enum is an enumerated type (or
<em>enumeration</em>). For example, let us create an enumeration of colors</p>
<p>All these examples can be found in <code class="file docutils literal notranslate"><span class="pre">examples/play-with-enums.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colorList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colors</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">Enum</span><span class="p">(</span><span class="n">colorList</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we used a simple list giving the names of enumerated values, but we left
the choice of concrete values up to the Enum class. Let us see the enumerated
pairs to check those values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Colors:&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">])</span>
<span class="go">Colors: [(&#39;blue&#39;, 2), (&#39;black&#39;, 4), (&#39;white&#39;, 3), (&#39;green&#39;, 1), (&#39;red&#39;, 0)]</span>
</pre></div>
</div>
<p>Names have been given automatic integer concrete values. We can iterate over
values in an enumeration, but we will usually be more interested in
accessing single values. We can get the concrete value associated with a name
by accessing it as an attribute or as an item (the later can be useful for
names not resembling Python identifiers):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Value of &#39;red&#39; and &#39;white&#39;:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">red</span><span class="p">,</span> <span class="n">colors</span><span class="o">.</span><span class="n">white</span><span class="p">))</span>
<span class="go">Value of &#39;red&#39; and &#39;white&#39;: (0, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Value of &#39;yellow&#39;:&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">.</span><span class="n">yellow</span><span class="p">)</span>
<span class="go">Value of &#39;yellow&#39;:</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
  File <span class="nb">&quot;.../tables/misc/enum.py&quot;</span>, line <span class="m">230</span>, in <span class="n">__getattr__</span>
<span class="w">    </span><span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>\<span class="o">*</span><span class="n">ke</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
<span class="gr">AttributeError</span>: <span class="n">no enumerated value with that name: &#39;yellow&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Value of &#39;red&#39; and &#39;white&#39;:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">]))</span>
<span class="go">Value of &#39;red&#39; and &#39;white&#39;: (0, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Value of &#39;yellow&#39;:&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">])</span>
<span class="go">Value of &#39;yellow&#39;:</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
  File <span class="nb">&quot;.../tables/misc/enum.py&quot;</span>, line <span class="m">189</span>, in <span class="n">__getitem__</span>
<span class="w">    </span><span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;no enumerated value with that name: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,))</span>
<span class="gr">KeyError</span>: <span class="n">&quot;no enumerated value with that name: &#39;yellow&#39;&quot;</span>
</pre></div>
</div>
<p>See how accessing a value that is not in the enumeration raises the
appropriate exception. We can also do the opposite and get the name
that matches a concrete value by using the __call__() method of Enum:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name of value </span><span class="si">{</span><span class="n">colors</span><span class="o">.</span><span class="n">red</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">red</span><span class="p">))</span>
<span class="go">Name of value 0: red</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Name of value 1234:&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="p">(</span><span class="mi">1234</span><span class="p">))</span>
<span class="go">Name of value 1234:</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
  File <span class="nb">&quot;.../tables/misc/enum.py&quot;</span>, line <span class="m">320</span>, in <span class="n">__call__</span>
<span class="w">    </span><span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="gr">ValueError</span>: <span class="n">no enumerated value with that concrete value: 1234</span>
</pre></div>
</div>
<p>You can see what we made as using the enumerated type to <em>convert</em> a concrete
value into a name in the enumeration. Of course, values out of the
enumeration can not be converted.</p>
<section id="enumerated-columns">
<h3>Enumerated columns<a class="headerlink" href="#enumerated-columns" title="Link to this heading">¶</a></h3>
<p>Columns of an enumerated type can be declared by using the EnumCol (see
<a class="reference internal" href="libref/declarative_classes.html#colclassdescr"><span class="std std-ref">The Col class and its descendants</span></a>) class. To see how this works, let us open a new
PyTables file and create a table to collect the simulated results of a
probabilistic experiment. In it, we have a bag full of colored balls; we take
a ball out and annotate the time of extraction and the color of the ball:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h5f</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="s1">&#39;enum.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">BallExt</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">IsDescription</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ballTime</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">Time32Col</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ballColor</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">EnumCol</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tbl</span> <span class="o">=</span> <span class="n">h5f</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;extractions&#39;</span><span class="p">,</span> <span class="n">BallExt</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Random ball extractions&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>We declared the ballColor column to be of the enumerated type colors, with a
default value of black. We also stated that we are going to store concrete
values as unsigned 8-bit integer values <a class="footnote-reference brackets" href="#id8" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p>
<p>Let us use some random values to fill the table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">tbl</span><span class="o">.</span><span class="n">row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ballTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span> <span class="o">+</span> <span class="n">i</span>
<span class="gp">... </span>    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ballColor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">colorList</span><span class="p">)]</span>  <span class="c1"># take note of this</span>
<span class="gp">... </span>    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Notice how we used the __getitem__() call of colors to get the concrete value
to store in ballColor. This way of appending values to a table automatically checks
for the validity on enumerated values. For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ballTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span> <span class="o">+</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ballColor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1234</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;tableextension.pyx&quot;</span>, line <span class="m">1086</span>, in <span class="n">tableextension.Row.__setitem__</span>
  File <span class="nb">&quot;.../tables/misc/enum.py&quot;</span>, line <span class="m">320</span>, in <span class="n">__call__</span>
<span class="w">    </span><span class="s2">&quot;no enumerated value with that concrete value: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,))</span>
<span class="gr">ValueError</span>: <span class="n">no enumerated value with that concrete value: 1234</span>
</pre></div>
</div>
<p>Note that this check is performed <em>only</em> by row.append() and not in other
methods such as tbl.append() or tbl.modify_rows(). Now, after flushing the
table we can see the result of insertions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tbl</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">tbl</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ballTime</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;ballTime&#39;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">ballColor</span> <span class="o">=</span> <span class="n">colors</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;ballColor&#39;</span><span class="p">])</span>  <span class="c1"># notice this</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ball extracted on </span><span class="si">%d</span><span class="s2"> is of color </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ballTime</span><span class="p">,</span> <span class="n">ballColor</span><span class="p">))</span>
<span class="go">Ball extracted on 1173785568 is of color green.</span>
<span class="go">Ball extracted on 1173785569 is of color black.</span>
<span class="go">Ball extracted on 1173785570 is of color white.</span>
<span class="go">Ball extracted on 1173785571 is of color black.</span>
<span class="go">Ball extracted on 1173785572 is of color black.</span>
<span class="go">Ball extracted on 1173785573 is of color red.</span>
<span class="go">Ball extracted on 1173785574 is of color green.</span>
<span class="go">Ball extracted on 1173785575 is of color red.</span>
<span class="go">Ball extracted on 1173785576 is of color white.</span>
<span class="go">Ball extracted on 1173785577 is of color white.</span>
</pre></div>
</div>
<p>As a final note, you may be wondering how to access an enumeration associated
with ballColor once the file is closed and reopened. You can call tbl.get_enum(‘ballColor’)
(see <a class="reference internal" href="libref/structured_storage.html#tables.Table.get_enum" title="tables.Table.get_enum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.get_enum()</span></code></a>) to get the enumeration back.</p>
</section>
<section id="enumerated-arrays">
<h3>Enumerated arrays<a class="headerlink" href="#enumerated-arrays" title="Link to this heading">¶</a></h3>
<p>EArray and VLArray leaves can also be declared to store enumerated values by
means of the EnumAtom (see <a class="reference internal" href="libref/declarative_classes.html#atomclassdescr"><span class="std std-ref">The Atom class and its descendants</span></a>) class, which works very
much like EnumCol for tables. Also, Array leaves can be used to open native
HDF enumerated arrays.</p>
<p>Let us create a sample EArray containing ranges of working days as
bidimensional values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">workingDays</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Mon&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Tue&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Wed&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Thu&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Fri&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dayRange</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">EnumAtom</span><span class="p">(</span><span class="n">workingDays</span><span class="p">,</span> <span class="s1">&#39;Mon&#39;</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="s1">&#39;uint16&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">earr</span> <span class="o">=</span> <span class="n">h5f</span><span class="o">.</span><span class="n">create_earray</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;days&#39;</span><span class="p">,</span> <span class="n">dayRange</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Working day ranges&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">earr</span><span class="o">.</span><span class="n">flavor</span> <span class="o">=</span> <span class="s1">&#39;python&#39;</span>
</pre></div>
</div>
<p>Nothing unusual, except for two details. Firstly, we use
a <em>dictionary</em> instead of a list to explicitly set concrete values in the
enumeration. Secondly, there is no explicit Enum instance created!
Instead, the dictionary is passed as the first argument to the constructor of
EnumAtom. If the constructor receives a list or a dictionary instead of an
enumeration, it automatically builds the enumeration from it.</p>
<p>Now let us feed some data to the array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wdays</span> <span class="o">=</span> <span class="n">earr</span><span class="o">.</span><span class="n">get_enum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">earr</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="n">wdays</span><span class="o">.</span><span class="n">Mon</span><span class="p">,</span> <span class="n">wdays</span><span class="o">.</span><span class="n">Fri</span><span class="p">),</span> <span class="p">(</span><span class="n">wdays</span><span class="o">.</span><span class="n">Wed</span><span class="p">,</span> <span class="n">wdays</span><span class="o">.</span><span class="n">Fri</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">earr</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="n">wdays</span><span class="o">.</span><span class="n">Mon</span><span class="p">,</span> <span class="mi">1234</span><span class="p">)])</span>
</pre></div>
</div>
<p>Please note that, since we had no explicit Enum instance, we were forced to
use get_enum() (see <a class="reference internal" href="libref/homogenous_storage.html#earraymethodsdescr"><span class="std std-ref">EArray methods</span></a>) to get it from the array (we
could also have used dayRange.enum).  Also note that we were able to append
an invalid value (1234). Array methods do not check the validity of
enumerated values.</p>
<p>Finally, we will print contents of the array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">earr</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;From </span><span class="si">{</span><span class="n">wdays</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="p">{</span><span class="n">wdays</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span><span class="w"> </span><span class="p">({</span><span class="n">d2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">d1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="n">days</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)</span>
<span class="go">From Mon to Fri (5 days).</span>
<span class="go">From Wed to Fri (3 days).</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">2</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;.../tables/misc/enum.py&quot;</span>, line <span class="m">320</span>, in <span class="n">__call__</span>
<span class="w">    </span><span class="s2">&quot;no enumerated value with that concrete value: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,))</span>
<span class="gr">ValueError</span>: <span class="n">no enumerated value with that concrete value: 1234</span>
</pre></div>
</div>
<p>That was an example of operating on concrete values. It also showed how the
value-to-name conversion failed because of the value not belonging to the
enumeration.</p>
<p>Now we will close the file, and this little tutorial on enumerated types is
done:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h5f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="nested-structures-in-tables">
<h2>Nested structures in tables<a class="headerlink" href="#nested-structures-in-tables" title="Link to this heading">¶</a></h2>
<p>PyTables supports handling of nested structures (or, in other words, nested datatypes)
in table objects, allowing you to define nested columns of arbitrary depth.</p>
<p>Why is that useful? Suppose your data has a certain structure on the column level,
which you would like to represent in the data model. You can do so by creating
nested subclasses of IsDescription. The benefit is the ability to group
and retrieve data more easily. Example below may be a bit silly, but it will serve
as an illustration of the concept:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tables</span> <span class="k">as</span> <span class="nn">tb</span>

<span class="k">class</span> <span class="nc">Info</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">IsDescription</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A sub-structure of NestedDescr&quot;&quot;&quot;</span>
    <span class="n">_v_pos</span> <span class="o">=</span> <span class="mi">2</span>   <span class="c1"># The position in the whole structure</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">StringCol</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">Float64Col</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">colors</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">Enum</span><span class="p">([</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">])</span>

<span class="k">class</span> <span class="nc">NestedDescr</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">IsDescription</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A description that has several nested columns&quot;&quot;&quot;</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">EnumCol</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="s1">&#39;uint32&#39;</span><span class="p">)</span>
    <span class="n">info1</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">Info</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">info2</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">IsDescription</span><span class="p">):</span>
        <span class="n">_v_pos</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">StringCol</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">Float64Col</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">info3</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">IsDescription</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">Float64Col</span><span class="p">(</span><span class="n">dflt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">UInt8Col</span><span class="p">(</span><span class="n">dflt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>NestedDescr is the root class with two <em>substructures</em> in it: info1 and info2. Note info1 is an instance of class Info which is defined prior to NestedDescr. info2 is declared within NestedDescr. Also, there is a third substructure, info3, that is in turn declared within substructure info2. You can define positions of substructures in the containing object by declaring special class attribute _v_pos.</p>
<section id="creating-nested-tables">
<h3>Creating nested tables<a class="headerlink" href="#creating-nested-tables" title="Link to this heading">¶</a></h3>
<p>Now that we have defined our nested structure, let’s create a <em>nested</em> table,
that is a table with columns which contain subcolumns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="s2">&quot;nested-tut.h5&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">fileh</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="n">NestedDescr</span><span class="p">)</span>
</pre></div>
</div>
<p>Done! Now, to populate the table with values, assign a value to each field. Referencing nested fields can be accomplished by providing a full path. Follow the structure defined earlier - use ‘/’ to access each sublevel of the structure, similar to how you would access a subdirectory on a Unix filesystem:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]]</span>
<span class="gp">... </span>    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;info1/name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;name1-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="gp">... </span>    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;info2/name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;name2-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="gp">... </span>    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;info2/info3/y&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">i</span>
<span class="gp">... </span>    <span class="c1"># Remaining fields will be filled with defaults</span>
<span class="gp">... </span>    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">nrows</span>
<span class="go">10</span>
</pre></div>
</div>
<p>As demonstrated above, substructure’s field can be accessed by specifying its full path as defined in the table hierarchy.</p>
</section>
<section id="reading-nested-tables">
<h3>Reading nested tables<a class="headerlink" href="#reading-nested-tables" title="Link to this heading">¶</a></h3>
<p>Now, what happens if we want to read the table? What kind of data container
would we get? Let’s find out:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nra</span> <span class="o">=</span> <span class="n">table</span><span class="p">[::</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nra</span>
<span class="go">array([(((1.0, 0), &#39;name2-0&#39;, 0.0), (&#39;name1-0&#39;, 0.0), 0L),</span>
<span class="go">       (((1.0, 4), &#39;name2-4&#39;, 0.0), (&#39;name1-4&#39;, 0.0), 1L),</span>
<span class="go">       (((1.0, 8), &#39;name2-8&#39;, 0.0), (&#39;name1-8&#39;, 0.0), 2L)],</span>
<span class="go">       dtype=[(&#39;info2&#39;, [(&#39;info3&#39;, [(&#39;x&#39;, &#39;&gt;f8&#39;), (&#39;y&#39;, &#39;\|u1&#39;)]),</span>
<span class="go">              (&#39;name&#39;, &#39;\|S10&#39;), (&#39;value&#39;, &#39;&gt;f8&#39;)]),</span>
<span class="go">              (&#39;info1&#39;, [(&#39;name&#39;, &#39;\|S10&#39;), (&#39;value&#39;, &#39;&gt;f8&#39;)]),</span>
<span class="go">              (&#39;color&#39;, &#39;&gt;u4&#39;)])</span>
</pre></div>
</div>
<p>What we’ve got is a NumPy array with a <em>compound, nested datatype</em>, i.e. its dtype is
a list of name-datatype tuples. For every fourth row in the table (note [::4]), we get one resulting row,
giving a total of three.</p>
<p>You can make use of the above object in many different ways.
For example, you can use it to append new data to an existing table object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nra</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">nrows</span>
<span class="go">13</span>
</pre></div>
</div>
<p>Or to create new tables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span> <span class="o">=</span> <span class="n">fileh</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">fileh</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s1">&#39;table2&#39;</span><span class="p">,</span> <span class="n">nra</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span><span class="p">[:]</span>
<span class="go">array([(((1.0, 0), &#39;name2-0&#39;, 0.0), (&#39;name1-0&#39;, 0.0), 0L),</span>
<span class="go">       (((1.0, 4), &#39;name2-4&#39;, 0.0), (&#39;name1-4&#39;, 0.0), 1L),</span>
<span class="go">       (((1.0, 8), &#39;name2-8&#39;, 0.0), (&#39;name1-8&#39;, 0.0), 2L)],</span>
<span class="go">       dtype=[(&#39;info2&#39;, [(&#39;info3&#39;, [(&#39;x&#39;, &#39;&lt;f8&#39;), (&#39;y&#39;, &#39;\|u1&#39;)]),</span>
<span class="go">              (&#39;name&#39;, &#39;\|S10&#39;), (&#39;value&#39;, &#39;&lt;f8&#39;)]),</span>
<span class="go">              (&#39;info1&#39;, [(&#39;name&#39;, &#39;\|S10&#39;), (&#39;value&#39;, &#39;&lt;f8&#39;)]),</span>
<span class="go">              (&#39;color&#39;, &#39;&lt;u4&#39;)])</span>
</pre></div>
</div>
<p>Finally, you can select nested values that meet an arbitrary condition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;info2/name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">table</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">colors</span><span class="o">.</span><span class="n">red</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span>
<span class="go">[&#39;name2-0&#39;, &#39;name2-3&#39;, &#39;name2-6&#39;, &#39;name2-9&#39;, &#39;name2-0&#39;]</span>
</pre></div>
</div>
<p>Note that row accessor does not provide natural naming feature, so
you have to specify an absolute path to your desired column in order to
access it.</p>
</section>
<section id="using-cols-accessor">
<h3>Using Cols accessor<a class="headerlink" href="#using-cols-accessor" title="Link to this heading">¶</a></h3>
<p>We can use cols attribute object (see <a class="reference internal" href="libref/structured_storage.html#colsclassdescr"><span class="std std-ref">The Cols class</span></a>) of the table
to conveniently access data stored in a substructure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">info2</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">array([((1.0, 1), &#39;name2-1&#39;, 0.0), ((1.0, 2), &#39;name2-2&#39;, 0.0),</span>
<span class="go">       ((1.0, 3), &#39;name2-3&#39;, 0.0), ((1.0, 4), &#39;name2-4&#39;, 0.0)],</span>
<span class="go">       dtype=[(&#39;info3&#39;, [(&#39;x&#39;, &#39;&lt;f8&#39;), (&#39;y&#39;, &#39;\|u1&#39;)]), (&#39;name&#39;, &#39;\|S10&#39;),</span>
<span class="go">              (&#39;value&#39;, &#39;&lt;f8&#39;)])</span>
</pre></div>
</div>
<p>Here, we have made use of the cols accessor to access <em>info2</em>
substructure and a slice operation to retrieve a subset of data we
were interested in; you probably recognized natural naming approach
used here as well. We can continue and ask for data in <em>info3</em> substructure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">info2</span><span class="o">.</span><span class="n">info3</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">array([(1.0, 1), (1.0, 2), (1.0, 3), (1.0, 4)],</span>
<span class="go">       dtype=[(&#39;x&#39;, &#39;&lt;f8&#39;), (&#39;y&#39;, &#39;\|u1&#39;)])</span>
</pre></div>
</div>
<p>You can also use the _f_col method to get a handler for the column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">_f_col</span><span class="p">(</span><span class="s1">&#39;info2&#39;</span><span class="p">)</span>
<span class="go">/table.cols.info2 (Cols), 3 columns</span>
<span class="go">  info3 (Cols(), Description)</span>
<span class="go">  name (Column(), \|S10)</span>
<span class="go">  value (Column(), float64)</span>
</pre></div>
</div>
<p>Here, you’ve got another Cols object handler because <em>info2</em> was a nested
column. If you select a non-nested column, you will get a regular Column
instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">_f_col</span><span class="p">(</span><span class="s1">&#39;info2/info3/y&#39;</span><span class="p">)</span>
<span class="go">/table.cols.info2.info3.y (Column(), uint8, idx=None)</span>
</pre></div>
</div>
<p>To summarize, cols accessor is a very handy and powerful tool to access data
in nested tables. Don’t hesitate to use it, especially when doing interactive work.</p>
</section>
<section id="accessing-meta-information-of-nested-tables">
<h3>Accessing meta-information of nested tables<a class="headerlink" href="#accessing-meta-information-of-nested-tables" title="Link to this heading">¶</a></h3>
<p>Tables have a <em>description</em> attribute, which returns an instance of
the Description class (see <a class="reference internal" href="libref/structured_storage.html#descriptionclassdescr"><span class="std std-ref">The Description class</span></a>) with table meta-data.
It can be helpful in understanding the table structure, including nested columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">description</span>
<span class="go">{</span>
<span class="go">  &quot;info2&quot;: {</span>
<span class="go">    &quot;info3&quot;: {</span>
<span class="go">      &quot;x&quot;: Float64Col(shape=(), dflt=1.0, pos=0),</span>
<span class="go">      &quot;y&quot;: UInt8Col(shape=(), dflt=1, pos=1)},</span>
<span class="go">    &quot;name&quot;: StringCol(itemsize=10, shape=(), dflt=&#39;&#39;, pos=1),</span>
<span class="go">    &quot;value&quot;: Float64Col(shape=(), dflt=0.0, pos=2)},</span>
<span class="go">  &quot;info1&quot;: {</span>
<span class="go">    &quot;name&quot;: StringCol(itemsize=10, shape=(), dflt=&#39;&#39;, pos=0),</span>
<span class="go">    &quot;value&quot;: Float64Col(shape=(), dflt=0.0, pos=1)},</span>
<span class="go">  &quot;color&quot;: EnumCol(enum=Enum({&#39;blue&#39;: 2, &#39;green&#39;: 1, &#39;red&#39;: 0}), dflt=&#39;red&#39;,</span>
<span class="go">                   base=UInt32Atom(shape=(), dflt=0), shape=(), pos=2)}</span>
</pre></div>
</div>
<p>As you can see, it provides very useful information on both the format and
the structure of columns in your table.</p>
<p>You can use natural naming approach with the description attribute to gain access to subcolumn’s
meta-data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">info1</span>
<span class="go">{&quot;name&quot;: StringCol(itemsize=10, shape=(), dflt=&#39;&#39;, pos=0),</span>
<span class="go"> &quot;value&quot;: Float64Col(shape=(), dflt=0.0, pos=1)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">info2</span><span class="o">.</span><span class="n">info3</span>
<span class="go">{&quot;x&quot;: Float64Col(shape=(), dflt=1.0, pos=0),</span>
<span class="go"> &quot;y&quot;: UInt8Col(shape=(), dflt=1, pos=1)}</span>
</pre></div>
</div>
<p>_v_nested_names attribute provides names of columns as well as structures embedded in them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">_v_nested_names</span>
<span class="go">[(&#39;info2&#39;, [(&#39;info3&#39;, [&#39;x&#39;, &#39;y&#39;]), &#39;name&#39;, &#39;value&#39;]),</span>
<span class="go"> (&#39;info1&#39;, [&#39;name&#39;, &#39;value&#39;]), &#39;color&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">info1</span><span class="o">.</span><span class="n">_v_nested_names</span>
<span class="go">[&#39;name&#39;, &#39;value&#39;]</span>
</pre></div>
</div>
<p>Regardless of which level of the structure is accessed, the output of _v_nested_names contains
the same kind of information. This is because even for nested structures, a Description
object is returned.</p>
<p>It is possible to create arrays that immitate nested table-like structure with _v_nested_descr attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">_v_nested_descr</span>
<span class="go">[(&#39;info2&#39;, [(&#39;info3&#39;, [(&#39;x&#39;, &#39;()f8&#39;), (&#39;y&#39;, &#39;()u1&#39;)]), (&#39;name&#39;, &#39;()S10&#39;),</span>
<span class="go"> (&#39;value&#39;, &#39;()f8&#39;)]), (&#39;info1&#39;, [(&#39;name&#39;, &#39;()S10&#39;), (&#39;value&#39;, &#39;()f8&#39;)]),</span>
<span class="go"> (&#39;color&#39;, &#39;()u4&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">rec</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">_v_nested_descr</span><span class="p">)</span>
<span class="go">recarray([],</span>
<span class="go">      dtype=[(&#39;info2&#39;, [(&#39;info3&#39;, [(&#39;x&#39;, &#39;&gt;f8&#39;), (&#39;y&#39;, &#39;|u1&#39;)]),</span>
<span class="go">             (&#39;name&#39;, &#39;|S10&#39;), (&#39;value&#39;, &#39;&gt;f8&#39;)]),</span>
<span class="go">             (&#39;info1&#39;, [(&#39;name&#39;, &#39;|S10&#39;), (&#39;value&#39;, &#39;&gt;f8&#39;)]),</span>
<span class="go">             (&#39;color&#39;, &#39;&gt;u4&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">rec</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<span class="go">        None, shape=0, dtype=table.description.info2._v_nested_descr</span>
<span class="go">    )</span>
<span class="go">recarray([],</span>
<span class="go">      dtype=[(&#39;info3&#39;, [(&#39;x&#39;, &#39;&gt;f8&#39;), (&#39;y&#39;, &#39;|u1&#39;)]), (&#39;name&#39;, &#39;|S10&#39;),</span>
<span class="go">             (&#39;value&#39;, &#39;&gt;f8&#39;)])</span>
</pre></div>
</div>
<p>Last but not least, there is a special iterator of the Description class: _f_walk,
which returns different columns of the table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">coldescr</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">_f_walk</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;column--&gt; </span><span class="si">{</span><span class="n">coldescr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">column--&gt; Description([(&#39;info2&#39;, [(&#39;info3&#39;, [(&#39;x&#39;, &#39;()f8&#39;), (&#39;y&#39;, &#39;()u1&#39;)]),</span>
<span class="go">                       (&#39;name&#39;, &#39;()S10&#39;), (&#39;value&#39;, &#39;()f8&#39;)]),</span>
<span class="go">                       (&#39;info1&#39;, [(&#39;name&#39;, &#39;()S10&#39;), (&#39;value&#39;, &#39;()f8&#39;)]),</span>
<span class="go">                       (&#39;color&#39;, &#39;()u4&#39;)])</span>
<span class="go">column--&gt; EnumCol(enum=Enum({&#39;blue&#39;: 2, &#39;green&#39;: 1, &#39;red&#39;: 0}), dflt=&#39;red&#39;,</span>
<span class="go">                            base=UInt32Atom(shape=(), dflt=0), shape=(), pos=2)</span>
<span class="go">column--&gt; Description([(&#39;info3&#39;, [(&#39;x&#39;, &#39;()f8&#39;), (&#39;y&#39;, &#39;()u1&#39;)]), (&#39;name&#39;, &#39;()S10&#39;),</span>
<span class="go">                       (&#39;value&#39;, &#39;()f8&#39;)])</span>
<span class="go">column--&gt; StringCol(itemsize=10, shape=(), dflt=&#39;&#39;, pos=1)</span>
<span class="go">column--&gt; Float64Col(shape=(), dflt=0.0, pos=2)</span>
<span class="go">column--&gt; Description([(&#39;name&#39;, &#39;()S10&#39;), (&#39;value&#39;, &#39;()f8&#39;)])</span>
<span class="go">column--&gt; StringCol(itemsize=10, shape=(), dflt=&#39;&#39;, pos=0)</span>
<span class="go">column--&gt; Float64Col(shape=(), dflt=0.0, pos=1)</span>
<span class="go">column--&gt; Description([(&#39;x&#39;, &#39;()f8&#39;), (&#39;y&#39;, &#39;()u1&#39;)])</span>
<span class="go">column--&gt; Float64Col(shape=(), dflt=1.0, pos=0)</span>
<span class="go">column--&gt; UInt8Col(shape=(), dflt=1, pos=1)</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="libref/structured_storage.html#descriptionclassdescr"><span class="std std-ref">The Description class</span></a> for a complete listing of attributes
and methods of the Description object.</p>
<p>Well, this is the end of this tutorial. As always, remember to close
your files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fileh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally, you may want to have a look at your resulting data file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ptdump<span class="w"> </span>-d<span class="w"> </span>nested-tut.h5
/<span class="w"> </span><span class="o">(</span>RootGroup<span class="o">)</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
/table<span class="w"> </span><span class="o">(</span>Table<span class="o">(</span><span class="m">13</span>,<span class="o">))</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">  </span>Data<span class="w"> </span>dump:
<span class="o">[</span><span class="m">0</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">0</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-0&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-0&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>0L<span class="o">)</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">1</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-1&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-1&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>1L<span class="o">)</span>
<span class="o">[</span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">2</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-2&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-2&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>2L<span class="o">)</span>
<span class="o">[</span><span class="m">3</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">3</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-3&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-3&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>0L<span class="o">)</span>
<span class="o">[</span><span class="m">4</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">4</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-4&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-4&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>1L<span class="o">)</span>
<span class="o">[</span><span class="m">5</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">5</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-5&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-5&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>2L<span class="o">)</span>
<span class="o">[</span><span class="m">6</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">6</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-6&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-6&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>0L<span class="o">)</span>
<span class="o">[</span><span class="m">7</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">7</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-7&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-7&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>1L<span class="o">)</span>
<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">8</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-8&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-8&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>2L<span class="o">)</span>
<span class="o">[</span><span class="m">9</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">9</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-9&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-9&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>0L<span class="o">)</span>
<span class="o">[</span><span class="m">10</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">0</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-0&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-0&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>0L<span class="o">)</span>
<span class="o">[</span><span class="m">11</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">4</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-4&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-4&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>1L<span class="o">)</span>
<span class="o">[</span><span class="m">12</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">8</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-8&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-8&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>2L<span class="o">)</span>
/table2<span class="w"> </span><span class="o">(</span>Table<span class="o">(</span><span class="m">3</span>,<span class="o">))</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">  </span>Data<span class="w"> </span>dump:
<span class="o">[</span><span class="m">0</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">0</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-0&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-0&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>0L<span class="o">)</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">4</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-4&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-4&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>1L<span class="o">)</span>
<span class="o">[</span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">(((</span><span class="m">1</span>.0,<span class="w"> </span><span class="m">8</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;name2-8&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span><span class="o">(</span><span class="s1">&#39;name1-8&#39;</span>,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>,<span class="w"> </span>2L<span class="o">)</span>
</pre></div>
</div>
<p>Most of the code in this section is also available in
<code class="file docutils literal notranslate"><span class="pre">examples/nested-tut.py</span></code>.</p>
<p>PyTables provides a comprehensive set of tools to work with nested structures and to address your classification needs.
Try to avoid nesting your data too deeply as it may lead to very long and convoluted series of lists, tuples, and description objects, which can be hard to read and understand.</p>
</section>
</section>
<section id="other-examples-in-pytables-distribution">
<h2>Other examples in PyTables distribution<a class="headerlink" href="#other-examples-in-pytables-distribution" title="Link to this heading">¶</a></h2>
<p>Feel free to examine the rest of examples in directory <code class="file docutils literal notranslate"><span class="pre">examples/</span></code>, and
try to understand them. We have written several practical sample scripts to
give you an idea of the PyTables capabilities, its way of dealing with HDF5
objects, and how it can be used in the real world.</p>
<hr class="docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Appending data to arrays is also supported, but you need to create
special objects called EArray (see <a class="reference internal" href="libref/homogenous_storage.html#earrayclassdescr"><span class="std std-ref">The EArray class</span></a> for more
info).</p>
</aside>
<aside class="footnote brackets" id="id6" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Note that you can append not only scalar values to tables,
but also fully multidimensional array objects.</p>
</aside>
<aside class="footnote brackets" id="id7" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>You can even <em>hide</em> nodes temporarily. Can you think of a way to do it?</p>
</aside>
<aside class="footnote brackets" id="id8" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>In fact, only integer values are supported right now, but
this may change in the future.</p>
</aside>
</aside>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="libref.html" class="btn btn-neutral float-right" title="Library Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011–2023, PyTables maintainers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>